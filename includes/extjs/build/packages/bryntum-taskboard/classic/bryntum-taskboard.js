var $jscomp={};$jscomp.scope={};$jscomp.defineProperty=typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=(a);if(a.get||a.set){throw new TypeError('ES3 does not support getters and setters.')}if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(c,b,a){var d=this.length;c=Number(c);b=Number(b);a=Number(a!=null?a:d);if(c<b){a=Math.min(a,d);while(b<a){if(b in this){this[c++]=this[b++]}else {delete this[c++];b++}}}else {a=Math.min(a,d+b-c);c+=a-b;while(a>b){if(--a in this){this[--c]=this[a]}else {delete this[c]}}}return this};return b},'es6-impl','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return ($jscomp.SYMBOL_PREFIX+(a||'')+$jscomp.symbolCounter_++)};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;if(!a){a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global.Symbol.iterator]=function(){return this};return (a)};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(a,b){return [a,b]})};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(e,b,a){var c=this.length||0;if(b<0){b=Math.max(0,c+(b))}if(a==null||a>c){a=c}a=Number(a);if(a<0){a=Math.max(0,c+a)}for(var d=Number(b||0);d<a;d++){this[d]=e}return this};return b},'es6-impl','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=(String(a))}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(b,a){return $jscomp.findInternal(this,b,a).v};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(b,a){return $jscomp.findInternal(this,b,a).i};return b},'es6-impl','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(a,b,f){$jscomp.initSymbolIterator();b=b!=null?b:function(a){return a};var c=[];var e=(a)[Symbol.iterator];if(typeof e=='function'){a=e.call(a);var g;while(!(g=a.next()).done){c.push(b.call((f),g.value))}}else {var h=a.length;for(var d=0;d<h;d++){c.push(b.call((f),a[d]))}}return c};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(a){return a})};return b},'es6-impl','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(a){return Array.from(arguments)};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,a){return a})};return b},'es6','es3');$jscomp.executeAsyncGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(a){if(a.done){b(a.value)}else {Promise.resolve(a.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=(a)[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator((a))};$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new (c)([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if(isConformant()){return c}var a='$jscomp_hidden_'+Math.random().toString().substring(2);function insert(b){if(!$jscomp.owns(b,a)){var c={};$jscomp.defineProperty(b,a,{value:c})}}function patch(a){var b=Object[a];if(b){Object[a]=function(a){insert(a);return b(a)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(a);var b;while(!(b=e.next()).done){var c=b.value;this.set((c[0]),(c[1]))}}};b.prototype.set=function(b,c){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=c;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6-impl','es3');$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.polyfill('Map',function(b){var h=!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(k){return !1}}();if(h){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap();var c=function(){};c.prototype.previous;c.prototype.next;c.prototype.head;c.prototype.key;c.prototype.value;var a=function(a){this.data_={};this.head_=g();this.size=0;if(a){var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=(b).value;this.set((c[0]),(c[1]))}}};a.prototype.set=function(c,b){var a=d(this,c);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:c,value:b};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=b}return this};a.prototype['delete']=function(b){var a=d(this,b);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};a.prototype.has=function(a){return !!d(this,a).entry};a.prototype.get=function(b){var a=d(this,b).entry;return (a&&(a.value))};a.prototype.entries=function(){return e(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return e(this,function(a){return a.key})};a.prototype.values=function(){return e(this,function(a){return a.value})};a.prototype.forEach=function(d,c){var e=this.entries();var b;while(!(b=e.next()).done){var a=b.value;d.call((c),(a[1]),(a[0]),this)}};(a.prototype)[Symbol.iterator]=a.prototype.entries;var d=function(f,d){var e=j(d);var a=f.data_[e];if(a&&$jscomp.owns(f.data_,e)){for(var c=0;c<a.length;c++){var b=a[c];if(d!==d&&b.key!==b.key||d===b.key){return {id:e,list:a,index:c,entry:b}}}}return {id:e,list:a,index:-1,entry:undefined}};var e=function(b,c){var a=b.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=b.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:c(a)}}a=null}return {done:!0,value:void 0}})};var g=function(){var a={};a.previous=a.next=a.head=a;return a};var i=0;var j=function(a){var b=a&&typeof a;if(b=='object'||b=='function'){a=(a);if(!f.has(a)){var c=''+ ++i;f.set(a,c);return c}return f.get(a)}return 'p_'+a};return a},'es6-impl','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};return b},'es6-impl','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(a){a=Number(a);if(a===0){return a}var b=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(a){a=Number(a);if(a<0.25&&a>-0.25){var e=a;var f=1;var b=a;var c=0;var d=1;while(c!=b){e*=a;d*=-1;b=(c=b)+d*e/++f}return b}return Math.log(1+a)};return b},'es6-impl','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(b){b=Number(b);return (a(b)-a(-b))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(a){if(a===0){return a}a=Number(a);var b=Math.pow(Math.abs(a),1/3);return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(a){a=Number(a)>>>0;if(a===0){return 32}var b=0;if((a&4.29490176E9)===0){a<<=16;b+=16}if((a&4.27819008E9)===0){a<<=8;b+=8}if((a&4.02653184E9)===0){a<<=4;b+=4}if((a&3.221225472E9)===0){a<<=2;b+=2}if((a&2.147483648E9)===0){b++}return b};return b},'es6-impl','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(a){a=Number(a);return (b(a)+b(-a))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(a){a=Number(a);if(a<0.25&&a>-0.25){var d=a;var e=1;var b=a;var c=0;while(c!=b){d*=a/++e;b=(c=b)+d}return b}return Math.exp(a)-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(b,c,g){b=Number(b);c=Number(c);var a,f,e;var d=Math.max(Math.abs(b),Math.abs(c));for(a=2;a<arguments.length;a++){d=Math.max(d,Math.abs(arguments[a]))}if(d>1.0E100||d<1.0E-100){b=b/d;c=c/d;e=b*b+c*c;for(a=2;a<arguments.length;a++){f=Number(arguments[a])/d;e+=f*f}return Math.sqrt(e)*d}else {e=b*b+c*c;for(a=2;a<arguments.length;a++){f=Number(arguments[a]);e+=f*f}return Math.sqrt(e)}};return b},'es6-impl','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(a,b){a=Number(a);b=Number(b);var e=a>>>16&65535;var c=a&65535;var f=b>>>16&65535;var d=b&65535;var g=e*d+c*f<<16>>>0;return c*d+g|0};return b},'es6-impl','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(a){return Math.log(a)/Math.LN10};return b},'es6-impl','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(a){return Math.log(a)/Math.LN2};return b},'es6-impl','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(a){a=Number(a);return a===0||isNaN(a)?a:a>0?1:-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(a){a=Number(a);if(a===0){return a}return (b(a)-b(-a))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(a){a=Number(a);if(a===0){return a}var b=Math.exp(-2*Math.abs(a));var c=(1-b)/(1+b);return a<0?-c:c};return b},'es6-impl','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(a){a=Number(a);if(isNaN(a)||a===Infinity||a===-Infinity||a===0){return a}var b=Math.floor(Math.abs(a));return a<0?-b:b};return b},'es6-impl','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6-impl','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(a){if(typeof a!=='number'){return !1}return !isNaN(a)&&a!==Infinity&&a!==-Infinity};return b},'es6-impl','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(a){if(!Number.isFinite(a)){return !1}return a===Math.floor(a)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(a){return typeof a==='number'&&isNaN(a)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(a){return Number.isInteger(a)&&Math.abs(a)<=Number.MAX_SAFE_INTEGER};return b},'es6-impl','es3');$jscomp.polyfill('Object.assign',function(a){if(a){return a}var b=function(d,e){for(var c=1;c<arguments.length;c++){var a=arguments[c];if(!a){continue}for(var b in a){if($jscomp.owns(a,b)){d[b]=a[b]}}}return d};return b},'es6-impl','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6-impl','es5');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(a,b){if(a===b){return a!==0||1/a===1/(b)}else {return a!==a&&b!==b}};return b},'es6-impl','es3');$jscomp.polyfill('Object.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a};return b},'es6','es5');$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];delete b[a];try{c()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(c){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{c(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(c){return function(d){if(!a){a=!0;c.call(b,d)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_((b))}else {if(isObject(b)){this.resolveToNonPromiseObj_((b))}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,(b))}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(c,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+c+', '+a|'): Promise already settled in state'+this.state_)}this.state_=c;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){var b=this.onSettledCallbacks_;for(var a=0;a<b.length;++a){(b[a]).call();b[a]=null}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,c){var a=this.createResolveAndReject_();try{b.call(c,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(e,f){var b;var c;var d=new a(function(a,d){b=a;c=d});function createCallback(a,d){if(typeof a=='function'){return function(d){try{b(a(d))}catch(g){c(g)}}}else {return d}}this.callWhenSettled_(createCallback(e,b),createCallback(f,c));return d};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(c,e){var a=this;function callback(){switch(a.state_){case b.FULFILLED:c(a.result_);break;case b.REJECTED:e(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(function(){d.asyncExecute(callback)})}};a.resolve=function(b){if(b instanceof a){return b}else {return new a(function(a,c){a(b)})}};a.reject=function(b){return new a(function(c,a){a(b)})};a.race=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var c=d.next();!c.done;c=d.next()){a.resolve(c.value).callWhenSettled_(e,f)}})};a.all=function(d){var c=$jscomp.makeIterator(d);var b=c.next();if(b.done){return a.resolve([])}else {return new a(function(f,g){var d=[];var e=0;function onFulfilled(a){return function(b){d[a]=b;e--;if(e==0){f(d)}}}do{d.push(undefined);e++;a.resolve(b.value).callWhenSettled_(onFulfilled(d.length-1),g);b=c.next()}while(!b.done)})}};if($jscomp.EXPOSE_ASYNC_EXECUTOR){a['$jscomp$new$AsyncExecutor']=function(){return new AsyncExecutor()}}return a},'es6-impl','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(d,b,a){return c.call(d,b,a)};return b},'es6','es3');$jscomp.polyfill('Reflect.construct',function(a){if(a){return a}var b=function(b,d,a){if(a===undefined){a=b}var e=a.prototype||Object.prototype;var c=Object.create(e);var f=Reflect.apply(b,c,d);return f||c};return b},'es6','es5');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(d,c,b){try{Object.defineProperty(d,c,b);var a=Object.getOwnPropertyDescriptor(d,c);if(!a){return !1}return a.configurable===(b.configurable||!1)&&a.enumerable===(b.enumerable||!1)&&('value' in a?a.value===b.value&&a.writable===(b.writable||!1):a.get===b.get&&a.set===b.set)}catch(e){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(b,a){if(!$jscomp.owns(b,a)){return !0}try{return delete b[a]}catch(c){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(c,b,d){if(arguments.length<=2){return c[b]}var a=$jscomp.findDescriptor(c,b);if(a){return a.get?a.get.call(d):a.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(b,a){return a in b};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if(typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(b){return b.substring(0,a.length)==a}var c=function(d){var e=[];var b=Object.getOwnPropertyNames(d);var c=Object.getOwnPropertySymbols(d);for(var a=0;a<b.length;a++){(isSymbol(b[a])?c:e).push(b[a])}return e.concat(c)};return c},'es6','es5');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(typeof Object.preventExtensions!='function'){return function(){return !1}}var b=function(a){Object.preventExtensions(a);return !Object.isExtensible(a)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(a,c,d,e){var b=$jscomp.findDescriptor(a,c);if(!b){if(Reflect.isExtensible(a)){a[c]=d;return !0}return !1}if(b.set){b.set.call(arguments.length>3?e:a,d);return !0}else {if(b.writable&&!Object.isFrozen(a)){a[c]=d;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(a,b){try{a.__proto__=b;return a.__proto__===b}catch(c){return !1}};return b},'es6','es5');$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.polyfill('Set',function(b){var c=!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}();if(c){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=(b).value;this.add(c)}}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(b){var a=this.map_['delete'](b);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};(a.prototype)[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(b,a){var c=this;this.map_.forEach(function(d){return b.call((a),d,d,c)})};return a},'es6-impl','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(a){var d=$jscomp.checkStringArgs(this,null,'codePointAt');var e=d.length;a=Number(a)||0;if(!(a>=0&&a<e)){return void 0}a=a|0;var b=d.charCodeAt(a);if(b<55296||b>56319||a+1===e){return b}var c=d.charCodeAt(a+1);if(c<56320||c>57343){return b}return (b-55296)*1024+c+9216};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(a,b){var c=$jscomp.checkStringArgs(this,a,'endsWith');a=a+'';if(b===void 0){b=c.length}var e=Math.max(0,Math.min(b|0,c.length));var d=a.length;while(d>0&&e>0){if(c[--e]!=a[--d]){return !1}}return d<=0};return b},'es6-impl','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(d){var b='';for(var c=0;c<arguments.length;c++){var a=Number(arguments[c]);if(a<0||a>1114111||a!==Math.floor(a)){throw new RangeError('invalid_code_point '+a)}if(a<=65535){b+=String.fromCharCode(a)}else {a-=65536;b+=String.fromCharCode(a>>>10&1023|55296);b+=String.fromCharCode(a&1023|56320)}}return b};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(a,b){var c=$jscomp.checkStringArgs(this,a,'includes');return c.indexOf(a,b||0)!==-1};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(a){var b=$jscomp.checkStringArgs(this,null,'repeat');if(a<0||a>1342177279){throw new RangeError('Invalid count value')}a=a|0;var c='';while(a){if(a&1){c+=b}if(a>>>=1){b+=b}}return c};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(a,f){var b=$jscomp.checkStringArgs(this,a,'startsWith');a=a+'';var g=b.length;var d=a.length;var e=Math.max(0,Math.min((f)|0,b.length));var c=0;while(c<d&&e<g){if(b[e++]!=a[c++]){return !1}}return c>=d};return b},'es6-impl','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){function tempCtor(){}tempCtor.prototype=b.prototype;a.prototype=new tempCtor();a.prototype.constructor=a;for(var c in b){if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}};$jscomp.polyfill('WeakSet',function(b){function isConformant(){if(!b||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var a=new (b)([c]);if(!a.has(c)||a.has(d)){return !1}a['delete'](c);a.add(d);return !a.has(c)&&a.has(d)}catch(e){return !1}}if(isConformant()){return b}var a=function(a){this.map_=new WeakMap();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=$jscomp.makeIterator(a);var b;while(!(b=d.next()).done){var c=b.value;this.add(c)}}};a.prototype.add=function(a){this.map_.set(a,!0);return this};a.prototype.has=function(a){return this.map_.has(a)};a.prototype['delete']=function(a){return this.map_['delete'](a)};return a},'es6-impl','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}Ext.define('Sch.util.Patch',{uses:['Ext.util.Cookies','Ext.data.Connection','Ext.Component'],target:null,minVersion:null,maxVersion:null,reportUrl:null,obsoleteTestName:null,description:null,applyFn:null,ieOnly:!1,macOnly:!1,overrides:null,onClassExtended:function(b,a){if(Sch.disableOverrides){return}if(a.ieOnly&&!Ext.isIE){return}if(a.macOnly&&!Ext.isMac){return}if((!a.minVersion||Ext.versions.extjs.equals(a.minVersion)||Ext.versions.extjs.isGreaterThan(a.minVersion))&&(!a.maxVersion||Ext.versions.extjs.equals(a.maxVersion)||Ext.versions.extjs.isLessThan(a.maxVersion))){Ext.require(a.target,function(){if(a.applyFn){a.applyFn()}else {if(a.overrides){Ext.ClassManager.get(a.target).override(a.overrides)}}})}}});Ext.define('Kanban.patch.EXTJS_23846',{extend:'Sch.util.Patch',requires:['Ext.dom.Element','Ext.event.publisher.Gesture'],target:['Ext.dom.Element','Ext.event.publisher.Gesture'],maxVersion:'6.2.2',applyFn:function(){if(Ext.firefoxVersion<51){return}if(!Ext.ClassManager.isCreated('EXTJS_23846.Element')){Ext.define('EXTJS_23846.Element',{override:'Ext.dom.Element'},function(e){var c=Ext.supports,d=e.prototype,b=d.eventMap,a=d.additiveEvents;if(Ext.os.is.Desktop&&c.TouchEvents&&!c.PointerEvents){b.touchstart='mousedown';b.touchmove='mousemove';b.touchend='mouseup';b.touchcancel='mouseup';a.mousedown='mousedown';a.mousemove='mousemove';a.mouseup='mouseup';a.touchstart='touchstart';a.touchmove='touchmove';a.touchend='touchend';a.touchcancel='touchcancel';a.pointerdown='mousedown';a.pointermove='mousemove';a.pointerup='mouseup';a.pointercancel='mouseup'}})}if(!Ext.ClassManager.isCreated('EXTJS_23846.Gesture')){Ext.define('EXTJS_23846.Gesture',{override:'Ext.event.publisher.Gesture'},function(b){var a=b.instance;if(Ext.supports.TouchEvents&&!Ext.isWebKit&&Ext.os.is.Desktop){a.handledDomEvents.push('mousedown','mousemove','mouseup');a.registerEvents()}})}}});Ext.define('Sch.data.mixin.UniversalModelGetter',{onClassMixedIn:function(a){var b={};if(a.prototype.isTreeStore){b.getModelById=a.prototype.getNodeById}else {b.getModelById=a.prototype.getById}if(a.prototype.isTreeStore){b.getModelByInternalId=function(a){return this.byInternalIdMap[a]||null}}else {b.getModelByInternalId=a.prototype.getByInternalId}Ext.override(a,b)}});Ext.define('Sch.data.mixin.CacheHintHelper',{extend:'Ext.Mixin',mixinConfig:{before:{loadRecords:'loadRecords',removeAll:'removeAll'}},loadRecords:function(){this.fireEvent('cacheresethint',this)},removeAll:function(a){if(a){this.fireEvent('cacheresethint',this)}}});Ext.define('Sch.data.mixin.ResourceStore',{eventStore:null,getEventStore:function(){return this.eventStore},setEventStore:function(b){var a=this,c;if(a.eventStore!==b){c=a.eventStore;a.eventStore=b&&Ext.StoreMgr.lookup(b)||null;a.fireEvent('eventstorechange',a,b,c)}},getScheduledEventsInTimeSpan:function(c,d,a){var b=[];var e=Sch.util.Date;a=a||this.getEventStore();Ext.Array.each(this.getRange(),function(e){Ext.Array.each(a.getEventsForResource(e),function(a){if(a.intersectsRange(c,d)){b.push(a)}})});return b}});Ext.define('Robo.data.Store',{extend:'Ext.Mixin',requires:['Ext.util.Observable'],undoRedoPostponed:null,inUndoRedoTransaction:!1,undoRedoEventBus:null,mixinConfig:{before:{constructor:'constructor',destroy:'destroy',fireEventArgs:'fireEventArgs',setRoot:'beforeSetRoot',fillNode:'beforeFillNode'},after:{setRoot:'afterSetRoot',fillNode:'afterFillNode'}},constructor:function(){var a=this;a.undoRedoEventBus=new Ext.util.Observable()},destroy:function(){Ext.destroy(this.undoRedoEventBus)},fireEventArgs:function(b,a){var c=this;if(!a.hasOwnProperty('$undoRedoEventBusFired')){a.$undoRedoEventBusFired={}}if(!a.$undoRedoEventBusFired[b]){a.$undoRedoEventBusFired[b]=!0;c.undoRedoEventBus.hasListener(b)&&c.undoRedoEventBus.fireEventArgs(b,a)}},isInUndoRedoTransaction:function(){return this.inUndoRedoTransaction},onUndoRedoTransactionStart:function(b,a){this.inUndoRedoTransaction=!0},onUndoRedoTransactionEnd:function(b,a){this.inUndoRedoTransaction=!1},isUndoingOrRedoing:function(){return !!this.undoRedoPostponed},beforeUndoRedo:function(a){this.undoRedoPostponed=[]},afterUndoRedo:function(b){var a=this;if(a.undoRedoPostponed){Ext.Array.forEach(a.undoRedoPostponed,function(a){a()})}a.undoRedoPostponed=null},postponeAfterUndoRedo:function(a){this.undoRedoPostponed.push(a)},beforeSetRoot:function(){this.__isSettingRoot=!0},afterSetRoot:function(){this.__isSettingRoot=!1;if(!this.getRoot()){this.fireEvent('clear',this)}},beforeFillNode:function(a){if(a.isRoot()){this.beforeSetRoot()}},afterFillNode:function(a){if(a.isRoot()){this.afterSetRoot()}},isRootSettingOrLoading:function(){return this.isLoading()||this.isTreeStore&&this.__isSettingRoot}});Ext.define('Sch.locale.Locale',{l10n:null,localeName:null,namespaceId:null,constructor:function(){if(!Sch.locale.Active){Sch.locale.Active={};this.bindRequire()}var b=this.self.getName().split('.');var c=this.localeName=b.pop();this.namespaceId=b.join('.');var a=Sch.locale.Active[this.namespaceId];if(!(c=='En'&&a&&a.localeName!='En')){this.apply()}},bindRequire:function(){var a=Ext.ClassManager.triggerCreated;Ext.ClassManager.triggerCreated=function(b){a.apply(this,arguments);if(b){var d=Ext.ClassManager.get(b);for(var c in Sch.locale.Active){Sch.locale.Active[c].apply(d)}}}},applyToClass:function(c,a){var e=this,d=e.self.getName();a=a||Ext.ClassManager.get(c);if(a&&a.activeLocaleId!==d){var b=e.l10n[c];if(typeof b==='function'){b(c)}else {if(a.singleton){a.l10n=Ext.apply({},b,a.prototype&&a.prototype.l10n)}else {if(a.prototype.hasOwnProperty('l10n')){b=Ext.apply({},b,a.prototype&&a.prototype.l10n)}Ext.override(a,{l10n:b})}}a.activeLocaleId=d;if(a.onLocalized){a.onLocalized()}}},apply:function(a){if(this.l10n){var e=this;if(a){if(!Ext.isArray(a)){a=[a]}var c,d;for(var b=0,g=a.length;b<g;b++){if(Ext.isObject(a[b])){if(a[b].singleton){d=a[b];c=Ext.getClassName(Ext.getClass(d))}else {d=Ext.getClass(a[b]);c=Ext.getClassName(d)}}else {d=null;c='string'===typeof a[b]?a[b]:Ext.getClassName(a[b])}if(c){if(c in this.l10n){e.applyToClass(c,d)}}}}else {Sch.locale.Active[this.namespaceId]=this;for(var f in this.l10n){e.applyToClass(f)}}}}});Ext.define('Sch.locale.En',{extend:'Sch.locale.Locale',singleton:!0,l10n:{'Sch.util.Date':{unitNames:{YEAR:{single:'year',plural:'years',abbrev:'yr'},QUARTER:{single:'quarter',plural:'quarters',abbrev:'q'},MONTH:{single:'month',plural:'months',abbrev:'mon'},WEEK:{single:'week',plural:'weeks',abbrev:'w'},DAY:{single:'day',plural:'days',abbrev:'d'},HOUR:{single:'hour',plural:'hours',abbrev:'h'},MINUTE:{single:'minute',plural:'minutes',abbrev:'min'},SECOND:{single:'second',plural:'seconds',abbrev:'s'},MILLI:{single:'ms',plural:'ms',abbrev:'ms'}}},'Sch.model.CalendarDay':{startTimeAfterEndTime:'Start time {0} is greater than end time {1}',availabilityIntervalsShouldNotIntersect:'Availability intervals should not intersect: [{0}] and [{1}]',invalidFormat:'Invalid format for availability string: {0}. It should have exact format: hh:mm-hh:mm'},'Sch.panel.SchedulerTree':{'All day':'All day'},'Sch.panel.SchedulerGrid':{'All day':'All day'},'Sch.panel.TimelineGridPanel':{weekStartDay:1,loadingText:'Loading, please wait...',savingText:'Saving changes, please wait...'},'Sch.panel.TimelineTreePanel':{weekStartDay:1,loadingText:'Loading, please wait...',savingText:'Saving changes, please wait...'},'Sch.mixin.SchedulerView':{loadingText:'Loading events...'},'Sch.plugin.CurrentTimeLine':{tooltipText:'Current time'},'Sch.widget.recurrence.ConfirmationDialog':{'delete-title':'You\u2019re deleting an event','delete-all-message':'Do you want to delete all occurrences of this event?','delete-further-message':'Do you want to delete this and all future occurrences of this event, or only the selected occurrence?','delete-all-btn-text':'Delete All','delete-further-btn-text':'Delete All Future Events','delete-only-this-btn-text':'Delete Only This Event','update-title':'You\u2019re changing a repeating event','update-all-message':'Do you want to change all occurrences of this event?','update-further-message':'Do you want to change only this occurrence of the event, or this and all future occurrences?','update-all-btn-text':'All','update-further-btn-text':'All Future Events','update-only-this-btn-text':'Only This Event','Yes':'Yes','Cancel':'Cancel'},'Sch.widget.recurrence.Dialog':{'Repeat event':'Repeat event','Cancel':'Cancel','Save':'Save'},'Sch.widget.recurrence.Form':{'Frequency':'Frequency','Every':'Every','DAILYintervalUnit':'day(s)','WEEKLYintervalUnit':'week(s) on:','MONTHLYintervalUnit':'month(s)','YEARLYintervalUnit':'year(s) in:','Each':'Each','On the':'On the','End repeat':'End repeat','time(s)':'time(s)'},'Sch.widget.recurrence.field.DaysComboBox':{'day':'day','weekday':'weekday','weekend day':'weekend day'},'Sch.widget.recurrence.field.PositionsComboBox':{'position1':'first','position2':'second','position3':'third','position4':'fourth','position5':'fifth','position-1':'last'},'Sch.data.util.recurrence.Legend':{', ':', ',' and ':' and ','Daily':'Daily','Weekly on {1}':'Weekly on {1}','Monthly on {1}':'Monthly on {1}','Yearly on {1} of {2}':'Yearly on {1} of {2}','Every {0} days':'Every {0} days','Every {0} weeks on {1}':'Every {0} weeks on {1}','Every {0} months on {1}':'Every {0} months on {1}','Every {0} years on {1} of {2}':'Every {0} years on {1} of {2}','position1':'the first','position2':'the second','position3':'the third','position4':'the fourth','position5':'the fifth','position-1':'the last','day':'day','weekday':'weekday','weekend day':'weekend day','daysFormat':'{0} {1}'},'Sch.widget.recurrence.field.StopConditionComboBox':{'Never':'Never','After':'After','On date':'On date'},'Sch.widget.recurrence.field.FrequencyComboBox':{'Daily':'Daily','Weekly':'Weekly','Monthly':'Monthly','Yearly':'Yearly'},'Sch.widget.recurrence.field.RecurrenceComboBox':{'None':'None','Custom...':'Custom...'},'Sch.widget.EventEditor':{'Repeat':'Repeat',saveText:'Save',deleteText:'Delete',cancelText:'Cancel',nameText:'Name',allDayText:'All day',startDateText:'Start',endDateText:'End',resourceText:'Resource'},'Sch.plugin.SimpleEditor':{newEventText:'New booking...'},'Sch.widget.ExportDialogForm':{formatFieldLabel:'Paper format',orientationFieldLabel:'Orientation',rangeFieldLabel:'Schedule range',showHeaderLabel:'Show header',showFooterLabel:'Show footer',orientationPortraitText:'Portrait',orientationLandscapeText:'Landscape',completeViewText:'Complete schedule',currentViewText:'Visible schedule',dateRangeText:'Date range',dateRangeFromText:'Export from',dateRangeToText:'Export to',exportersFieldLabel:'Control pagination',adjustCols:'Adjust column width',adjustColsAndRows:'Adjust column width and row height',specifyDateRange:'Specify date range',columnPickerLabel:'Select columns',completeDataText:'Complete schedule (for all events)',dpiFieldLabel:'DPI (dots per inch)',rowsRangeLabel:'Rows range',allRowsLabel:'All rows',visibleRowsLabel:'Visible rows',columnEmptyText:'[no title]'},'Sch.widget.ExportDialog':{title:'Export Settings',exportButtonText:'Export',cancelButtonText:'Cancel',progressBarText:'Exporting...'},'Sch.plugin.Export':{generalError:'An error occurred',fetchingRows:'Fetching row {0} of {1}',builtPage:'Built page {0} of {1}',requestingPrintServer:'Please wait...'},'Sch.plugin.Printable':{dialogTitle:'Print settings',exportButtonText:'Print',disablePopupBlocking:'Please disable pop-up blocker since the print-plugin needs to be able to open new tabs',popupBlockerDetected:'Browser pop-up blocker detected'},'Sch.plugin.exporter.AbstractExporter':{name:'Exporter'},'Sch.plugin.exporter.SinglePage':{name:'Single page'},'Sch.plugin.exporter.MultiPageVertical':{name:'Multiple pages (vertically)'},'Sch.plugin.exporter.MultiPage':{name:'Multiple pages'},'Sch.plugin.Split':{splitText:'Split',mergeText:'Hide split part'},'Sch.plugin.SummaryBar':{totalText:'Total'},'Sch.column.ResourceName':{name:'Name'},'Sch.template.DependencyInfo':{fromText:'From',toText:'To'},'Sch.preset.Manager':{hourAndDay:{displayDateFormat:'G:i',middleDateFormat:'G:i',topDateFormat:'D d/m'},secondAndMinute:{displayDateFormat:'g:i:s',topDateFormat:'D, d g:iA'},dayAndWeek:{displayDateFormat:'m/d h:i A',middleDateFormat:'D d M'},weekAndDay:{displayDateFormat:'m/d',bottomDateFormat:'d M',middleDateFormat:'Y F d'},weekAndMonth:{displayDateFormat:'m/d/Y',middleDateFormat:'m/d',topDateFormat:'m/d/Y'},weekAndDayLetter:{displayDateFormat:'m/d/Y',middleDateFormat:'D d M Y'},weekDateAndMonth:{displayDateFormat:'m/d/Y',middleDateFormat:'d',topDateFormat:'Y F'},monthAndYear:{displayDateFormat:'m/d/Y',middleDateFormat:'M Y',topDateFormat:'Y'},year:{displayDateFormat:'m/d/Y',middleDateFormat:'Y'},manyYears:{displayDateFormat:'m/d/Y',middleDateFormat:'Y'}}}});Ext.define('Sch.mixin.Localizable',{extend:'Ext.Mixin',requires:['Sch.locale.En'],activeLocaleId:'',l10n:null,inTextLocaleRegExp:/L\{([^}]+)\}/g,localizableProperties:null,isLocaleApplied:function(){var a=this.singleton&&this.activeLocaleId||this.self.activeLocaleId;if(!a){return !1}for(var b in Sch.locale.Active){if(a===Sch.locale.Active[b].self.getName()){return !0}}return !1},applyLocale:function(){for(var a in Sch.locale.Active){Sch.locale.Active[a].apply(this.singleton?this:this.self.getName())}},L:function(){return this.localize.apply(this,arguments)},localize:function(b,d,c){var a=this.getLocale(b,d,c);if(a===null||a===undefined){throw 'Cannot find locale: '+b+' ['+this.self.getName()+']'}return a},getLocale:function(a,f,e){if(!this.isLocaleApplied()&&!e){this.applyLocale()}if(this.hasOwnProperty('l10n')&&this.l10n&&this.l10n.hasOwnProperty(a)&&'function'!=typeof this.l10n[a]){return this.l10n[a]}var b=this.self&&this.self.prototype;var c=b.l10n&&b.l10n[a];if(c===null||c===undefined){var d=b&&b.superclass;if(d&&d.localize){c=d.localize(a,f,e)}}return c},localizeText:function(a){var b,c,d=this.inTextLocaleRegExp;while(b=d.exec(a)){if(c=this.getLocale(b[1])){a=a.replace(b[0],c)}}return a},localizeProperties:function(){var b=this,a=b.localizableProperties;if(a){a=a.split(',');for(var c=a.length-1;c>=0;c--){b[a[c]]=b.localizeText(b[a[c]])}}},mixinConfig:{before:{'initComponent':'beforeInitComponent'}},beforeInitComponent:function(){this.localizeProperties()}});Ext.define('Sch.util.Date',{requires:'Ext.Date',mixins:['Sch.mixin.Localizable'],singleton:!0,stripEscapeRe:/(\\.)/g,hourInfoRe:/([gGhHisucUOPZ]|MS)/,unitHash:null,unitsByName:{},MIN_VALUE:new Date(-8.64E15),MAX_VALUE:new Date(8.64E15),constructor:function(){var a=this,b=Ext.Date;var c=a.unitHash={MILLI:b.MILLI,SECOND:b.SECOND,MINUTE:b.MINUTE,HOUR:b.HOUR,DAY:b.DAY,WEEK:'w',MONTH:b.MONTH,QUARTER:'q',YEAR:b.YEAR};Ext.apply(a,c);a.units=[a.MILLI,a.SECOND,a.MINUTE,a.HOUR,a.DAY,a.WEEK,a.MONTH,a.QUARTER,a.YEAR]},onLocalized:function(){this.setUnitNames(this.L('unitNames'))},setUnitNames:function(e){var d=this.unitsByName={};this.l10n.unitNames=e;this._unitNames=Ext.apply({},e);var c=this.unitHash;for(var b in c){if(c.hasOwnProperty(b)){var a=c[b];this._unitNames[a]=this._unitNames[b];d[b]=a;d[a]=a}}},betweenLesser:function(a,b,c){return b<=a&&a<c},betweenLesserEqual:function(a,b,c){return b<=a&&a<=c},constrain:function(a,c,b){return this.min(this.max(a,c),b)},compareUnits:function(c,d){var a=Ext.Array.indexOf(this.units,c),b=Ext.Array.indexOf(this.units,d);return a>b?1:a<b?-1:0},isUnitGreater:function(a,b){return this.compareUnits(a,b)>0},copyTimeValues:function(a,b){a.setHours(b.getHours());a.setMinutes(b.getMinutes());a.setSeconds(b.getSeconds());a.setMilliseconds(b.getMilliseconds());return a},add:function(b,e,c){var a=Ext.Date.clone(b);if(!e||c===0){return a}switch(e.toLowerCase()){case this.MILLI:a=new Date(b.getTime()+c);break;case this.SECOND:a=new Date(b.getTime()+c*1000);break;case this.MINUTE:a=new Date(b.getTime()+c*60000);break;case this.HOUR:a=new Date(b.getTime()+c*3600000);break;case this.DAY:a.setDate(b.getDate()+c);if(a.getHours()===23&&b.getHours()===0){a=Ext.Date.add(a,Ext.Date.HOUR,1)};break;case this.WEEK:a.setDate(b.getDate()+c*7);break;case this.MONTH:var d=b.getDate();if(d>28){d=Math.min(d,Ext.Date.getLastDateOfMonth(this.add(Ext.Date.getFirstDateOfMonth(b),this.MONTH,c)).getDate())};a.setDate(d);a.setMonth(a.getMonth()+c);break;case this.QUARTER:a=this.add(b,this.MONTH,c*3);break;case this.YEAR:a.setFullYear(b.getFullYear()+c);break;}return a},getUnitDurationInMs:function(a){return this.add(new Date(1,0,1),a,1)-new Date(1,0,1)},getMeasuringUnit:function(a){if(a===this.WEEK){return this.DAY}return a},getDurationInUnit:function(b,c,e,d){var a;switch(e){case this.YEAR:a=this.getDurationInYears(b,c);break;case this.QUARTER:a=this.getDurationInMonths(b,c)/3;break;case this.MONTH:a=this.getDurationInMonths(b,c);break;case this.WEEK:a=this.getDurationInDays(b,c)/7;break;case this.DAY:a=this.getDurationInDays(b,c);break;case this.HOUR:a=this.getDurationInHours(b,c);break;case this.MINUTE:a=this.getDurationInMinutes(b,c);break;case this.SECOND:a=this.getDurationInSeconds(b,c);break;case this.MILLI:a=this.getDurationInMilliseconds(b,c);break;}return d?a:Math.round(a)},getUnitToBaseUnitRatio:function(b,a){if(b===a){return 1}switch(b){case this.YEAR:switch(a){case this.QUARTER:return 1/4;case this.MONTH:return 1/12;};break;case this.QUARTER:switch(a){case this.YEAR:return 4;case this.MONTH:return 1/3;};break;case this.MONTH:switch(a){case this.YEAR:return 12;case this.QUARTER:return 3;};break;case this.WEEK:switch(a){case this.DAY:return 1/7;case this.HOUR:return 1/168;};break;case this.DAY:switch(a){case this.WEEK:return 7;case this.HOUR:return 1/24;case this.MINUTE:return 1/1440;};break;case this.HOUR:switch(a){case this.DAY:return 24;case this.MINUTE:return 1/60;};break;case this.MINUTE:switch(a){case this.HOUR:return 60;case this.SECOND:return 1/60;case this.MILLI:return 1/60000;};break;case this.SECOND:switch(a){case this.MILLI:return 1/1000;};break;case this.MILLI:switch(a){case this.SECOND:return 1000;};break;}return -1},isUnitDivisibleIntoSubunit:function(c,b){var a=c===this.MONTH&&b===this.WEEK;return !a},getDurationInMilliseconds:function(a,b){return b-a},getDurationInSeconds:function(a,b){return (b-a)/1000},getDurationInMinutes:function(a,b){return (b-a)/60000},getDurationInHours:function(a,b){return (b-a)/3600000},getDurationInDays:function(a,b){var c=a.getTimezoneOffset()-b.getTimezoneOffset();return (b-a+c*60*1000)/86400000},getDurationInMonths:function(a,b){return (b.getFullYear()-a.getFullYear())*12+(b.getMonth()-a.getMonth())},getDurationInYears:function(a,b){return this.getDurationInMonths(a,b)/12},min:function(a,b){return (a&&a.valueOf()||a)<(b&&b.valueOf()||b)?a:b},max:function(a,b){return (a&&a.valueOf()||a)>(b&&b.valueOf()||b)?a:b},intersectSpans:function(a,c,b,d){return this.betweenLesser(a,b,d)||this.betweenLesser(b,a,c)},getNameOfUnit:function(a){a=this.getUnitByName(a);switch(a.toLowerCase()){case this.YEAR:return 'YEAR';case this.QUARTER:return 'QUARTER';case this.MONTH:return 'MONTH';case this.WEEK:return 'WEEK';case this.DAY:return 'DAY';case this.HOUR:return 'HOUR';case this.MINUTE:return 'MINUTE';case this.SECOND:return 'SECOND';case this.MILLI:return 'MILLI';}throw 'Incorrect UnitName'},getReadableNameOfUnit:function(b,a){if(!this.isLocaleApplied()){this.applyLocale()}return this._unitNames[b][a?'plural':'single']},getShortNameOfUnit:function(a){if(!this.isLocaleApplied()){this.applyLocale()}return this._unitNames[a].abbrev},getUnitByName:function(a){if(!this.isLocaleApplied()){this.applyLocale()}if(!this.unitsByName[a]){Ext.Error.raise('Unknown unit name: '+a)}return this.unitsByName[a]},getNext:function(h,c,b,d,g){var a=Ext.Date.clone(h);var j=g!=null;var e=g===0;var i=this.compareUnits(this.DAY,c)<=0||c===this.HOUR&&g%60!==0;if(j&&!e&&i){a=Sch.util.Date.toTimeZone(a,g)}d=arguments.length<4?1:d;b=b==null?1:b;switch(c){case this.MILLI:a=this.add(a,c,b);break;case this.SECOND:a=this.add(a,c,b);if(a.getMilliseconds()>0){a.setMilliseconds(0)};break;case this.MINUTE:a=this.add(a,c,b);if(a.getSeconds()>0){a.setSeconds(0)};if(a.getMilliseconds()>0){a.setMilliseconds(0)};break;case this.HOUR:if(e){a=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours()+b))}else {a=this.add(a,c,b);if(a.getMinutes()>0){a.setMinutes(0)}if(a.getSeconds()>0){a.setSeconds(0)}if(a.getMilliseconds()>0){a.setMilliseconds(0)}};break;case this.DAY:if(e){a=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()+b))}else {var l=a.getHours()===23&&this.add(a,this.HOUR,1).getHours()===1;if(l){a=this.add(a,this.DAY,2);this.clearTime(a);return a}this.clearTime(a);a=this.add(a,this.DAY,b);if(a.getHours()===1){this.clearTime(a)}};break;case this.WEEK:var f;if(e){f=a.getUTCDay();var m=d-f+7*(b-(d<=f?0:1));a.setUTCDate(a.getUTCDate()+m);a=this.clearUTCTime(a)}else {this.clearTime(a);f=a.getDay();a=this.add(a,this.DAY,d-f+7*(b-(d<=f?0:1)));if(a.getDay()!==d){a=this.add(a,this.HOUR,1)}else {this.clearTime(a)}};break;case this.MONTH:if(e){a=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth()+b,1))}else {a=this.add(a,this.MONTH,b);a.setDate(1);this.clearTime(a)};break;case this.QUARTER:if(e){var n=(b-1)*3+(3-a.getUTCMonth()%3);a=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth()+n,1))}else {a=this.add(a,this.MONTH,(b-1)*3+(3-a.getMonth()%3));this.clearTime(a);a.setDate(1)};break;case this.YEAR:if(e){a=new Date(Date.UTC(a.getUTCFullYear()+b,0,1))}else {a=new Date(a.getFullYear()+b,0,1)};break;default:throw new Error('Invalid date unit'+c);}if(j&&!e&&i){if(Sch.util.Date.compareUnits(Sch.util.Date.WEEK,c)>0){var k=a.getTimezoneOffset()-h.getTimezoneOffset();if(k!==0){a=Sch.util.Date.add(a,this.MINUTE,k)}}a=Sch.util.Date.fromTimeZone(a,g);if(a-h===0){a=this.getNext(h,c,b,d)}}return a},getNumberOfMsFromTheStartOfDay:function(a){return a-this.clearTime(a,!0)||86400000},getNumberOfMsTillTheEndOfDay:function(a){return this.getStartOfNextDay(a,!0)-a},getStartOfNextDay:function(a,c,d){var b=this.add(d?a:this.clearTime(a,c),this.DAY,1);if(b.getDate()==a.getDate()){var e=this.add(this.clearTime(a,c),this.DAY,2).getTimezoneOffset();var f=a.getTimezoneOffset();b=this.add(b,this.MINUTE,f-e)}return b},getEndOfPreviousDay:function(b,c){var a=c?b:this.clearTime(b,!0);if(a-b){return a}else {return this.add(a,this.DAY,-1)}},timeSpanContains:function(c,d,a,b){return a-c>=0&&d-b>=0},compareWithPrecision:function(a,b,d){var c=Sch.util.Date,e=Ext.Date,f;switch(d){case c.DAY:a=Number(e.format(a,'Ymd'));b=Number(e.format(b,'Ymd'));break;case c.WEEK:a=Number(e.format(a,'YmW'));b=Number(e.format(b,'YmW'));break;case c.MONTH:a=Number(e.format(a,'Ym'));b=Number(e.format(b,'Ym'));break;case c.QUARTER:a=a.getFullYear()*4+Math.floor(a.getMonth()/3);b=b.getFullYear()*4+Math.floor(b.getMonth()/3);break;case c.YEAR:a=a.getFullYear();b=b.getFullYear();break;default:case c.MILLI:case c.SECOND:case c.MINUTE:case c.HOUR:d=d&&this.getUnitDurationInMs(d)||1;a=Math.floor(a.valueOf()/d);b=Math.floor(b.valueOf()/d);break;}a<b&&(f=-1)||a>b&&(f=+1)||(f=0);return f},getValueInUnits:function(a,b){switch(b){case this.YEAR:return a.getFullYear();case this.QUARTER:return Math.floor(a.getMonth()/3)+1;case this.MONTH:return a.getMonth();case this.WEEK:return Ext.Date.getWeekOfYear(a);case this.DAY:return a.getDate();case this.HOUR:return a.getHours();case this.MINUTE:return a.getMinutes();case this.SECOND:return a.getSeconds();}},setValueInUnits:function(d,e,c){var b=Ext.Date.clone(d),a;switch(e){case this.YEAR:a='setFullYear';break;case this.MONTH:a='setMonth';break;case this.DAY:a='setDate';break;case this.HOUR:a='setHours';break;case this.MINUTE:a='setMinutes';break;case this.SECOND:a='setSeconds';break;case this.MILLI:a='setMilliseconds';break;}b[a](c);return b},getSubUnit:function(a){switch(a){case this.YEAR:return this.MONTH;case this.MONTH:return this.DAY;case this.DAY:return this.HOUR;case this.HOUR:return this.MINUTE;case this.MINUTE:return this.SECOND;case this.SECOND:return this.MILLI;}},setValueInSubUnits:function(c,a,b){a=this.getSubUnit(a);return this.setValueInUnits(c,a,b)},mergeDates:function(d,b,c){var a=Ext.Date.clone(d);switch(c){case this.YEAR:a.setFullYear(b.getFullYear());case this.MONTH:a.setMonth(b.getMonth());case this.WEEK:case this.DAY:if(c===this.WEEK){a=this.add(a,this.DAY,b.getDay()-a.getDay())}else {a.setDate(b.getDate())};case this.HOUR:a.setHours(b.getHours());case this.MINUTE:a.setMinutes(b.getMinutes());case this.SECOND:a.setSeconds(b.getSeconds());case this.MILLI:a.setMilliseconds(b.getMilliseconds());}return a},splitToSubUnits:function(c,d,a,b){a=a||1;b=arguments.length<4?1:b;switch(d){case this.MONTH:return this.splitMonth(c,a,b);case this.WEEK:case this.DAY:return this.splitDay(c,a);default:break;}},splitYear:function(e,d){var b=this.clearTime(e,!0);b.setMonth(0);b.setDate(1);var c=[];for(var a=0;a<=12;a=a+d){c.push(this.add(b,this.MONTH,a))}return c},splitMonth:function(h,f,e){var a=this.clearTime(h,!0);a.setDate(1);a=this.add(a,this.DAY,e-a.getDay());var b=Ext.Date.clone(a);var g=this.add(a,this.MONTH,1);var d=[];for(var c=0;b.getTime()<g.getTime();c=c+f){b=this.add(a,this.WEEK,c);d.push(b)}return d},splitWeek:function(d,f,e){var b=this.add(d,this.DAY,e-d.getDay());b=this.clearTime(b);var c=[];for(var a=0;a<=7;a=a+f){c.push(this.add(b,this.DAY,a))}return c},splitDay:function(d,c){var e=this.clearTime(d,!0);var b=[];for(var a=0;a<=24;a=a+c){b.push(this.add(e,this.HOUR,a))}return b},splitHour:function(e,d){var a=new Date(e.getTime());a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);var c=[];for(var b=0;b<=60;b=b+d){c.push(this.add(a,this.MINUTE,b))}return c},splitMinute:function(e,d){var b=Ext.Date.clone(e);b.setSeconds(0);b.setMilliseconds(0);var c=[];for(var a=0;a<=60;a=a+d){c.push(this.add(b,this.SECOND,a))}return c},clearTime:function(a,b){if(a.getHours()>0||a.getMinutes()>0||a.getSeconds()>0){return Ext.Date.clearTime(a,b)}return b?Ext.Date.clone(a):a},clearUTCTime:function(a){a=new Date(a);a.setUTCHours(0,0,0,0);return a},getWeekNumber:function(b){var a=new Date(b.valueOf());var d=(b.getDay()+6)%7;a.setDate(a.getDate()-d+3);var c=a.valueOf();a.setMonth(0,1);if(a.getDay()!=4){a.setMonth(0,1+(4-a.getDay()+7)%7)}return 1+Math.ceil((c-a)/604800000)},getWeekStartDate:function(c,a){var b=this.setDateToMidday(c,!0);a=typeof a!=='number'?1:a;while(b.getDay()!==a){b=Sch.util.Date.add(b,Sch.util.Date.DAY,-1)}return b},getWeekEndDate:function(c,a){var b=this.setDateToMidday(c,!0);a=typeof a!=='number'?0:a;while(b.getDay()!==a){b=Sch.util.Date.add(b,Sch.util.Date.DAY,1)}return b},setDateToHours:function(a,c,b){if(c){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),b)}a.setHours(b);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},setDateToMidnight:function(b,a){return this.setDateToHours(b,a,0)},setDateToMidday:function(b,a){return this.setDateToHours(b,a,12)},isLaterDate:function(b,a){return !this.isSameDate(b,a)&&b>a},isSameDate:function(b,a){return b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()&&b.getDate()===a.getDate()},isEarlierDate:function(b,a){return !this.isSameDate(b,a)&&b<a},toTimeZone:function(a,c){var d=a.getTimezoneOffset()+c;var b=this.add(a,this.MINUTE,d);return this.add(b,this.MINUTE,b.getTimezoneOffset()-a.getTimezoneOffset())},fromTimeZone:function(a,b){var c=-a.getTimezoneOffset()-b;return this.add(a,this.MINUTE,c)},getUTCTime:function(a){return new Date(2020,6,1,a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())},getUTCDate:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},format:function(e,a,f){if(f===0){a=a.replace('a','%10');a=a.replace('A','%11');a=a.replace('g','%12');a=a.replace('G','%13');a=a.replace('h','%14');a=a.replace('H','%15');a=a.replace('O','%16');a=a.replace('P','%17');a=a.replace('Z','%18');a=a.replace('c','%19');a=a.replace('d','%20');a=a.replace('D','%21');a=a.replace('j','%22');a=a.replace('l','%23');a=a.replace('N','%24');a=a.replace('w','%25');a=a.replace('z','%26');a=a.replace('F','%27');a=a.replace('m','%28');a=a.replace('M','%29');a=a.replace('n','%30');a=a.replace('Y','%31');a=a.replace('y','%32');var b=Ext.Date.format(e,a);var d=this.getUTCTime(e);var c=this.getUTCDate(e);b=b.replace('%10',Ext.Date.format(d,'a'));b=b.replace('%11',Ext.Date.format(d,'A'));b=b.replace('%12',Ext.Date.format(d,'g'));b=b.replace('%13',Ext.Date.format(d,'G'));b=b.replace('%14',Ext.Date.format(d,'h'));b=b.replace('%15',Ext.Date.format(d,'H'));b=b.replace('%16','+0000');b=b.replace('%17','+00:00');b=b.replace('%18','0');b=b.replace('%19',Ext.Date.format(c,'Y-m-d')+'T'+Ext.Date.format(d,'H:i:s+00:00'));b=b.replace('%20',Ext.Date.format(c,'d'));b=b.replace('%21',Ext.Date.format(c,'D'));b=b.replace('%22',Ext.Date.format(c,'j'));b=b.replace('%23',Ext.Date.format(c,'l'));b=b.replace('%24',Ext.Date.format(c,'N'));b=b.replace('%25',Ext.Date.format(c,'w'));b=b.replace('%26',Ext.Date.format(c,'z'));b=b.replace('%27',Ext.Date.format(c,'F'));b=b.replace('%28',Ext.Date.format(c,'m'));b=b.replace('%29',Ext.Date.format(c,'M'));b=b.replace('%30',Ext.Date.format(c,'n'));b=b.replace('%31',Ext.Date.format(c,'Y'));b=b.replace('%32',Ext.Date.format(c,'y'));return b}else {e=this.toTimeZone(e,f);return Ext.Date.format(e,a)}}});Ext.define('Robo.data.Model',{extend:'Ext.Mixin',modelName:null,editMementoFix:null,mixinConfig:{before:{endEdit:'onBeforeEndEdit'},after:{endEdit:'onAfterEndEdit'}},onBeforeEndEdit:function(c,b){var a=this.editMemento;if(a){this.editMementoFix=a;if(!b){b=this.getModifiedFieldNames(a.data)}if(!a.previousValues){a.previousValues={}}Ext.Array.each(b,function(b){a.previousValues[b]=a.data[b]})}},onAfterEndEdit:function(b,a){delete this.editMementoFix},getTitle:function(){return ''}});Ext.define('Sch.model.Customizable',function(a){return {extend:'Ext.data.Model',requires:['Sch.util.Date'],mixins:{robo:'Robo.data.Model'},isCustomizableModel:!0,customizableFields:null,previous:null,__editing:null,__editCounter:0,constructor:function(){var a=this.callParent(arguments);return a},storePreviousFlex:Ext.Function.flexSetter(function(d,c){var b=this,a=b.get(d);if(a instanceof Date&&!(c instanceof Date)){c=b.getField(d).convert(c,b)}if(a instanceof Date&&a-c||!(a instanceof Date)&&a!==c){if(b.processFieldPreviousValue){a=b.processFieldPreviousValue(d,a)}b.previous[d]=a}}),deletePreviousFlex:Ext.Function.flexSetter(function(a,b){delete this.previous[a]}),set:function(c,e){var a=this,b=!1,d=null;if(!a.previous){b=!0;a.previous={}}a.storePreviousFlex(c,e);d=a.callParent(arguments);if(!a.__editing){if(b){delete a.previous}else {a.deletePreviousFlex(c,e)}}return d},reject:function(){var a=this,c=a.modified||{},b;a.__editing=!0;a.previous=a.previous||{};for(b in c){if(c.hasOwnProperty(b)){if(typeof c[b]!='function'){a.previous[b]=a.get(b)}}}a.callParent(arguments);delete a.previous;a.__editing=!1},beginEdit:function(){this.__editCounter++;this.__editing=!0;this.callParent(arguments)},cancelEdit:function(){this.__editCounter=0;this.__editing=!1;this.callParent(arguments);delete this.previous},endEdit:function(b,a){if(--this.__editCounter===0){if(!b&&this.getModifiedFieldNames){var c=this.editMemento;if(!a){a=this.getModifiedFieldNames(c.data)}if(a&&a.length===0){b=!0}}this.callParent([b].concat(Array.prototype.slice.call(arguments,1)));this.__editing=!1;delete this.previous}}}},function(a){a.$onExtended.unshift({fn:function(b,a){if(a){if(Ext.isArray(a)){b.fieldsInitialValue=a.slice()}else {if(a.fields){if(!Ext.isArray(a.fields)){b.fieldsInitialValue=[a.fields]}else {b.fieldsInitialValue=a.fields.slice()}}}}}});a.onExtended(function(a,e,d){var b=Ext.ClassManager,c=b.triggerCreated;b.triggerCreated=function(i){var d=a.prototype;if(d.customizableFields){d.allCustomizableFields=(a.superclass.allCustomizableFields||[]).concat(d.customizableFields)}else {d.allCustomizableFields=a.superclass.allCustomizableFields||[]}var f={};Ext.Array.each(d.allCustomizableFields,function(a){if(typeof a=='string'){a={name:a}}f[a.name]=a});var h=d.fields;var g=[];var e=[];Ext.Array.each(h,function(a){if(a.isCustomizableField){e.push(a.getName())}});if(d.idProperty!=='id'&&d.getField('id')){if(!d.getField('id').hasOwnProperty('name')){e.push('id')}}if(d.idProperty!=='Id'&&d.getField('Id')){if(!d.getField('Id').hasOwnProperty('name')){e.push('Id')}}a.removeFields(e);function applyFieldConfig(e,a,d){if(!a){return}if(!Ext.isArray(a)){a=[a]}var c;for(var b=a.length-1;b>=0;b--){if(a[b].name==d){c=a[b];break}}Ext.applyIf(e,c)}function getFieldConfig(c){var d=a,b=d.prototype,f=c==='Id'?'idProperty':c.charAt(0).toLowerCase()+c.substr(1)+'Field',e={name:b[f]||c,isCustomizableField:!0},g;while(b&&b.isCustomizableModel){g=b[f]||c;b.hasOwnProperty('customizableFields')&&applyFieldConfig(e,b.customizableFields,c);applyFieldConfig(e,d.fieldsInitialValue,g);b=d.superclass;d=b&&b.self}return e}e=[];Ext.Object.each(f,function(l,j){var b=j.name||j.getName();var i=b==='Id'?'idProperty':b.charAt(0).toLowerCase()+b.substr(1)+'Field';var a=d[i]||b;d.getField(a)&&e.push(a);var k=getFieldConfig(b);g.push(Ext.create('data.field.'+(k.type||'auto'),k));var h=Ext.String.capitalize(b);if(h!='Id'){var c='get'+h;var f='set'+h;if(!d[c]||d[c].__getterFor__&&d[c].__getterFor__!=a){d[c]=function(){return this.get(this[i]||a)};d[c].__getterFor__=a}if(!d[f]||d[f].__setterFor__&&d[f].__setterFor__!=a){d[f]=function(b){return this.set(this[i]||a,b)};d[f].__setterFor__=a}}});a.replaceFields(g,e);c.apply(this,arguments);b.triggerCreated=c}})});Ext.define('Sch.model.Resource',{extend:'Sch.model.Customizable',isResourceModel:!0,idProperty:'Id',config:Ext.versions.touch?{idProperty:'Id'}:null,nameField:'Name',customizableFields:[{name:'Name',type:'string'}],getInternalId:function(){return this.internalId},getResourceStore:function(){return this.joined&&this.joined[0]||this.getTreeStore&&this.getTreeStore()},getEventStore:function(){var a=this.getResourceStore();return a&&a.getEventStore()||this.parentNode&&this.parentNode.getEventStore()},getAssignmentStore:function(){var a=this.getEventStore();return a&&a.getAssignmentStore()},getEvents:function(a){var b=this;a=a||b.getEventStore();return a&&a.getEventsForResource(b)||[]},getAssignments:function(){var b=this,a=b.getEventStore();return a&&a.getAssignmentsForResource(b)},isPersistable:function(){var a=this.parentNode;return !a||!a.phantom||a.isRoot&&a.isRoot()},isAbove:function(f){var d=this,h=d.getResourceStore(),g=!1,a,c,e,b,i;if(d==f){g=!1}else {if(h&&h.isTreeStore){a=d;c=[];while(a){c.push(a);a=a.parentNode}a=f;e=[];while(a){e.push(a);a=a.parentNode}b=0;while(b<c.length-1&&b<e.length-1&&c[b]==e[b]){++b}i=c[b];d=c[b+1];f=e[b+1];g=i.indexOf(d)<i.indexOf(f)}else {g=h.indexOf(d)<h.indexOf(f)}}return g}});Ext.define('Sch.data.ResourceStore',{extend:'Ext.data.Store',model:'Sch.model.Resource',config:{model:'Sch.model.Resource'},alias:'store.resourcestore',mixins:['Sch.data.mixin.UniversalModelGetter','Sch.data.mixin.CacheHintHelper','Sch.data.mixin.ResourceStore','Robo.data.Store'],storeId:'resources',constructor:function(){this.callParent(arguments);if(this.getModel()!==Sch.model.Resource&&!(this.getModel().prototype instanceof Sch.model.Resource)){throw 'The model for the ResourceStore must subclass Sch.model.Resource'}}});Ext.define('Kanban.model.Resource',{extend:'Sch.model.Resource',alias:'model.kanban_resourcemodel',customizableFields:[{name:'ImageUrl'}],imageUrlField:'ImageUrl'});Ext.define('Kanban.data.ResourceStore',{extend:'Sch.data.ResourceStore',model:'Kanban.model.Resource',sorters:'Name',proxy:undefined,alias:'store.kanban_resourcestore'});Ext.define('Sch.data.util.IdConsistencyManager',{config:{eventStore:null,resourceStore:null,assignmentStore:null,dependencyStore:null},eventStoreDetacher:null,resourceStoreDetacher:null,constructor:function(a){this.initConfig(a)},updateEventStore:function(b,c){var a=this;Ext.destroyMembers(a,'eventStoreDetacher');if(b){a.eventStoreDetacher=b.on({idchanged:a.onEventIdChanged,scope:a,destroyable:!0,priority:200})}},updateResourceStore:function(b,c){var a=this;Ext.destroyMembers(a,'resourceStoreDetacher');if(b){a.resourceStoreDetacher=b.on({idchanged:a.onResourceIdChanged,scope:a,destroyable:!0,priority:200})}},onEventIdChanged:function(h,i,g,f){var c=this,d=c.getAssignmentStore(),e=c.getDependencyStore(),b,a;if(d){b=c.getUpdateAssignmentEventIdFieldFn(d,g,f)}if(e){a=c.getUpdateDependencySourceTargedIdFieldFn(e,g,f)}if(b||a){h.on('update',function(){b&&b();a&&a()},null,{single:!0,priority:200})}},onResourceIdChanged:function(h,i,g,f){var c=this,e=c.getEventStore(),a=c.getAssignmentStore(),b,d;if(e&&!a){b=c.getUpdateEventResourceIdFieldFn(e,g,f)}if(a){d=c.getUpdateAssignmentResourceIdFieldFn(a,g,f)}if(b||a){h.on('update',function(){b&&b();d&&d()},null,{single:!0,priority:200})}},getUpdateEventResourceIdFieldFn:function(a,d,c){var b=a.getRange();return function(){Ext.Array.each(b,function(a){a.getResourceId()==d&&a.setResourceId(c)})}},getUpdateAssignmentEventIdFieldFn:function(b,a,d){var c=b.getAssignmentsForEvent(a);return function(){Ext.Array.each(c,function(b){b.getEventId()==a&&b.setEventId(d)})}},getUpdateAssignmentResourceIdFieldFn:function(b,a,d){var c=b.getAssignmentsForResource(a);return function(){Ext.Array.each(c,function(b){b.getResourceId()==a&&b.setResourceId(d)})}},getUpdateDependencySourceTargedIdFieldFn:function(c,a,b){var d=c.getEventDependencies(a);return function(){Ext.Array.each(d,function(c){c.getSourceId()==a&&c.setSourceId(b);c.getTargetId()==a&&c.setTargetId(b)})}}});Ext.define('Sch.data.util.ModelPersistencyManager',{config:{eventStore:null,resourceStore:null,assignmentStore:null,dependencyStore:null},eventStoreDetacher:null,resourceStoreDetacher:null,assignmentStoreDetacher:null,dependencyStoreDetacher:null,constructor:function(a){this.initConfig(a)},updateEventStore:function(b,c){var a=this;Ext.destroyMembers(a,'eventStoreDetacher');if(b&&b.autoSync){a.eventStoreDetacher=b.on({beforesync:a.onEventStoreBeforeSync,scope:a,destroyable:!0,priority:100})}},updateResourceStore:function(b,c){var a=this;Ext.destroyMembers(a,'resourceStoreDetacher');if(b&&b.autoSync){a.resourceStoreDetacher=b.on({beforesync:a.onResourceStoreBeforeSync,scope:a,destroyable:!0,priority:100})}},updateAssignmentStore:function(b,c){var a=this;Ext.destroyMembers(a,'assignmentStoreDetacher');if(b&&b.autoSync){a.assignmentStoreDetacher=b.on({beforesync:a.onAssignmentStoreBeforeSync,scope:a,destroyable:!0,priority:100})}},updateDependencyStore:function(b,c){var a=this;Ext.destroyMembers(a,'dependencyStoreDetacher');if(b&&b.autoSync){a.dependencyStoreDetacher=b.on({beforesync:a.onDependencyStoreBeforeSync,scope:a,destroyable:!0,priority:100})}},onEventStoreBeforeSync:function(a){var b=this;b.removeNonPersistableRecordsToCreate(a);return b.shallContinueSync(a)},onResourceStoreBeforeSync:function(a){var b=this;b.removeNonPersistableRecordsToCreate(a);return b.shallContinueSync(a)},onAssignmentStoreBeforeSync:function(a){var b=this;b.removeNonPersistableRecordsToCreate(a);return b.shallContinueSync(a)},onDependencyStoreBeforeSync:function(a){var b=this;b.removeNonPersistableRecordsToCreate(a);return b.shallContinueSync(a)},removeNonPersistableRecordsToCreate:function(d){var a=d.create||[],c,b;for(b=a.length-1;b>=0;--b){c=a[b];if(!c.isPersistable()){Ext.Array.remove(a,c)}}if(a.length===0){delete d.create}},shallContinueSync:function(a){return Boolean(a.create&&a.create.length>0||a.update&&a.update.length>0||a.destroy&&a.destroy.length>0)}});Ext.define('Sch.util.Cache',{cache:null,constructor:function(){var a=this;a.cache={}},key:function(a){var b;if(a&&a.isModel){b=a.getId().toString()}else {if(a===undefined||a===null){b='[ undefined / null ]'}else {b=a.toString()}}return b},has:function(a){var b=this;a=b.key(a);return b.cache.hasOwnProperty(a)},get:function(b,d){var c=this,a;b=c.key(b);a=c.cache.hasOwnProperty(b)&&c.cache[b];if(!a&&d){a=d()}else {if(!a){a=[]}}c.cache[b]=a;return a},add:function(c,d){var a=this,b=a.key(c);if(!a.cache.hasOwnProperty(b)){a.cache[b]=a.get(c)}arguments.length>1&&Ext.Array.include(a.cache[b],d);return a},set:function(d,c){var a=this,b=a.key(d);a.cache[b]=c;return a},remove:function(b,c){var a=this;b=a.key(b);if(a.cache.hasOwnProperty(b)){Ext.Array.remove(a.cache[b],c)}return a},move:function(b,c,d){var a=this;b=a.key(b);c=a.key(c);if(b!=c&&arguments.length>=3){a.remove(b,d);a.add(c,d)}else {if(b!=c&&a.cache.hasOwnProperty(b)&&a.cache.hasOwnProperty(c)){a.cache[c]=Ext.Array.union(a.cache[c],a.cache[b]);a.cache[b]=[]}else {if(b!=c&&a.cache.hasOwnProperty(b)){a.cache[c]=a.cache[b];a.cache[b]=[]}}}return a},clear:function(b){var a=this;if(!arguments.length){a.cache={}}else {b=a.key(b);if(a.cache.hasOwnProperty(b)){delete a.cache[b]}}return a},uncache:function(c){var a=this,b;for(b in a.cache){if(a.cache.hasOwnProperty(b)){a.cache[b]=Ext.Array.remove(a.cache[b],c)}}return a},inheritableStatics:{}});Ext.define('Sch.data.util.ResourceEventsCache',{extend:'Sch.util.Cache',requires:['Ext.data.Model'],eventStore:null,eventStoreDetacher:null,resourceStoreDetacher:null,constructor:function(b){var a=this,c=b.getResourceStore();a.callParent();function onEventAdd(c,b){Ext.Array.each(b,function(b){a.add(b.getResourceId(),b)})}function onEventRemove(c,b){Ext.Array.each(b,function(b){a.remove(b.getResourceId(),b)})}function onEventUpdate(g,b,h,f){var d=b.resourceIdField,c=b.previous&&d in b.previous,e=c&&b.previous[d];if(c){a.move(e,b.getResourceId(),b)}}function onEventStoreClearOrReset(){a.clear()}function onEventStoreResourceStoreChange(d,b,c){a.clear();attachToResourceStore(b)}function onResourceIdChanged(d,e,c,b){a.move(c,b)}function onResourceRemove(c,b){Ext.Array.each(b,function(b){a.clear(b)})}function onResourceStoreClearOrReset(){a.clear()}function attachToResourceStore(b){Ext.destroy(a.resourceStoreDetacher);a.resourceStoreDetacher=b&&b.on({idchanged:onResourceIdChanged,remove:onResourceRemove,clear:onResourceStoreClearOrReset,cacheresethint:onResourceStoreClearOrReset,rootchange:onResourceStoreClearOrReset,priority:100,destroyable:!0})}a.eventStoreDetacher=b.on({add:onEventAdd,remove:onEventRemove,update:onEventUpdate,clear:onEventStoreClearOrReset,cacheresethint:onEventStoreClearOrReset,rootchange:onEventStoreClearOrReset,resourcestorechange:onEventStoreResourceStoreChange,priority:100,destroyable:!0});a.eventStoreFiltersDetacher=b.getFilters().on('endupdate',onEventStoreClearOrReset,this,{priority:1002,destroyable:!0});attachToResourceStore(c);a.eventStore=b},destroy:function(){var a=this;Ext.destroyMembers(a,'eventStoreDetacher','eventStoreFiltersDetacher','resourceStoreDetacher');a.eventStore=null},get:function(a,b){var c=this;a=c.key(a);b=b||function(){return Ext.Array.filter(c.eventStore.getRange(),function(b){return b.getResourceId()==a})};return c.callParent([a,b])}});Ext.define('Sch.data.mixin.EventStore',{extend:'Ext.Mixin',requires:['Sch.util.Date','Sch.data.util.IdConsistencyManager','Sch.data.util.ModelPersistencyManager','Sch.data.util.ResourceEventsCache'],isEventStore:!0,assignmentStore:null,resourceStore:null,resourceEventsCache:null,idConsistencyManager:null,modelPersistencyManager:null,mixinConfig:{after:{constructor:'constructor',destroy:'destroy'}},constructor:function(){var a=this;a.resourceEventsCache=a.createResourceEventsCache();a.idConsistencyManager=a.createIdConsistencyManager();a.modelPersistencyManager=a.createModelPersistencyManager()},destroy:function(){var a=this;Ext.destroyMembers(a,'resourceEventsCache','idConsistencyManager','modelPersistencyManager')},createResourceEventsCache:function(){return new Sch.data.util.ResourceEventsCache(this)},createIdConsistencyManager:function(){var a=this;return new Sch.data.util.IdConsistencyManager({eventStore:a,resourceStore:a.getResourceStore(),assignmentStore:a.getAssignmentStore(),dependencyStore:a.getDependencyStore()})},createModelPersistencyManager:function(){var a=this;return new Sch.data.util.ModelPersistencyManager({eventStore:a,resourceStore:a.getResourceStore(),assignmentStore:a.getAssignmentStore(),dependencyStore:a.getDependencyStore()})},getResourceStore:function(){return this.resourceStore},setResourceStore:function(b){var a=this,c=a.resourceStore;if(a.resourceStore){a.resourceStore.setEventStore(null);a.idConsistencyManager&&a.idConsistencyManager.setResourceStore(null);a.modelPersistencyManager&&a.modelPersistencyManager.setResourceStore(null)}a.resourceStore=b&&Ext.StoreMgr.lookup(b)||null;if(a.resourceStore){a.modelPersistencyManager&&a.modelPersistencyManager.setResourceStore(a.resourceStore);a.idConsistencyManager&&a.idConsistencyManager.setResourceStore(a.resourceStore);b.setEventStore(a)}if((c||b)&&c!==b){a.fireEvent('resourcestorechange',a,b,c)}},getAssignmentStore:function(){return this.assignmentStore},setAssignmentStore:function(b){var a=this,c=a.assignmentStore;if(a.assignmentStore){a.assignmentStore.setEventStore(null);a.idConsistencyManager&&a.idConsistencyManager.setAssignmentStore(null);a.modelPersistencyManager&&a.modelPersistencyManager.setAssignmentStore(null)}a.assignmentStore=b&&Ext.StoreMgr.lookup(b)||null;if(a.assignmentStore){a.modelPersistencyManager&&a.modelPersistencyManager.setAssignmentStore(a.assignmentStore);a.idConsistencyManager&&a.idConsistencyManager.setAssignmentStore(a.assignmentStore);a.assignmentStore.setEventStore(a);Ext.destroy(a.resourceEventsCache)}else {a.resourceEventsCache=a.createResourceEventsCache()}if((c||b)&&c!==b){a.fireEvent('assignmentstorechange',a,b,c)}},getDependencyStore:function(){return this.dependencyStore},setDependencyStore:function(b){var a=this,c=a.DependencyStore;if(a.dependencyStore){a.dependencyStore.setEventStore(null);a.idConsistencyManager&&a.idConsistencyManager.setDependencyStore(null);a.modelPersistencyManager&&a.modelPersistencyManager.setDependencyStore(null)}a.dependencyStore=b&&Ext.StoreMgr.lookup(b)||null;if(a.dependencyStore){a.modelPersistencyManager&&a.modelPersistencyManager.setDependencyStore(a.dependencyStore);a.idConsistencyManager&&a.idConsistencyManager.setDependencyStore(a.dependencyStore);a.dependencyStore.setEventStore(a)}if((c||b)&&c!==b){a.fireEvent('dependencystorechange',a,b,c)}},isDateRangeAvailable:function(e,g,a,c){var f=Sch.util.Date,d=c?this.getEventsForResource(c):this.getRange(),b=!0;if(Sch.model.Assignment&&a instanceof Sch.model.Assignment){a=a.getEvent(this)}Ext.each(d,function(c){b=a===c||!f.intersectSpans(e,g,c.getStartDate(),c.getEndDate());return b});return b},getEventsInTimeSpan:function(b,d,e){var c=new Ext.util.MixedCollection();var a=[];if(e!==!1){var f=Sch.util.Date;this.forEachScheduledEvent(function(g,c,e){if(f.intersectSpans(c,e,b,d)){a.push(g)}})}else {this.forEachScheduledEvent(function(f,c,e){if(c-b>=0&&d-e>=0){a.push(f)}})}c.addAll(a);return c},getEventsByStartDate:function(c){var b=Sch.util.Date;var a=[];this.forEachScheduledEvent(function(e,d,f){if(b.compareWithPrecision(d,c,b.DAY)===0){a.push(e)}});return a},forEachScheduledEvent:function(b,a){this.each(function(c){var d=c.getStartDate(),e=c.getEndDate();if(d&&e){return b.call(a||this,c,d,e)}},this)},getTotalTimeSpan:function(){var a=Sch.util.Date.MAX_VALUE,b=Sch.util.Date.MIN_VALUE,c=Sch.util.Date;this.each(function(d){if(d.getStartDate()){a=c.min(d.getStartDate(),a)}if(d.getEndDate()){b=c.max(d.getEndDate(),b)}});a=a<Sch.util.Date.MAX_VALUE?a:null;b=b>Sch.util.Date.MIN_VALUE?b:null;this.lastTotalTimeSpan={start:a||null,end:b||a||null};return this.lastTotalTimeSpan},filterEventsForResource:function(a,d,c){var b=a.getEvents(this);return Ext.Array.filter(b,d,c||this)},append:function(a){throw 'Must be implemented by consuming class'},getResourcesForEvent:function(b){var c=this,d=c.getAssignmentStore(),e=c.getResourceStore(),a;if(d){a=d.getResourcesForEvent(b)}else {if(e){b=b instanceof Sch.model.Event&&b||c.getModelById(b);a=b&&e.getModelById(b.getResourceId());a=a&&[a]||[]}else {a=[]}}return a},getEventsForResource:function(d){var b=this,c=b.getAssignmentStore(),a;if(c){a=c.getEventsForResource(d)}else {if(b.resourceEventsCache){a=b.resourceEventsCache.get(d)}else {a=[]}}return a},getAssignmentsForEvent:function(b){var c=this,a=c.getAssignmentStore();return a&&a.getAssignmentsForEvent(b)||[]},getAssignmentsForResource:function(b){var c=this,a=c.getAssignmentStore();return a&&a.getAssignmentsForResource(b)||[]},assignEventToResource:function(b,a){var d=this,c=d.getAssignmentStore();if(c){c.assignEventToResource(b,a)}else {if(Ext.isArray(a)){a=a[0]}b=b instanceof Sch.model.Event&&b||d.getModelById(b);a=a instanceof Sch.model.Resource?a.getId():a;b&&b.setResourceId(a)}},unassignEventFromResource:function(a,b){var d=this,c=d.getAssignmentStore();if(c){c.unassignEventFromResource(a,b)}else {a=a instanceof Sch.model.Event&&a||d.getModelById(a);b=b instanceof Sch.model.Resource?b.getId():b;if(a&&(typeof b=='undefined'||a.getResourceId()==b)){a.setResourceId(null)}}},reassignEventFromResourceToResource:function(a,c,b){var g=this,d=g.getAssignmentStore();var e=b instanceof Sch.model.Resource?b.getId():b;var h=c instanceof Sch.model.Resource?c.getId():c;if(d){var f=d.getAssignmentForEventAndResource(a,c);if(f){f.setResourceId(e)}else {d.assignEventToResource(a,b)}}else {a=a instanceof Sch.model.Event&&a||g.getModelById(a);if(a.getResourceId()==h){a.setResourceId(e)}}},isEventAssignedToResource:function(a,b){var e=this,d=e.getAssignmentStore(),c;if(d){c=d.isEventAssignedToResource(a,b)}else {a=a instanceof Sch.model.Event&&a||e.getModelById(a);b=b instanceof Sch.model.Resource?b.getId():b;c=a&&a.getResourceId()==b||!1}return c},removeAssignmentsForEvent:function(a){var c=this,b=c.getAssignmentStore();if(b){b.removeAssignmentsForEvent(a)}else {a=a instanceof Sch.model.Event&&a||c.getModelById(a);a&&a.setResourceId(null)}},removeAssignmentsForResource:function(a){var b=this,c=b.getAssignmentStore(),d=b.getResourceStore();if(c){c.removeAssignmentsForResource(a)}else {if(d){a=a instanceof Sch.model.Resource&&a||d.getModelById(a);a&&Ext.Array.each(b.resourceEventsCache.get(a),function(a){a.setResourceId(null)})}else {a=a instanceof Sch.model.Resource?a.getId():a;Ext.Array.each(b.getRange(),function(b){b.getResourceId()==a&&b.setResourceId(null)})}}},isEventPersistable:function(f){var g=this,e=g.getAssignmentStore(),b,a,d,c=!0;if(!e){b=f.getResources();for(a=0,d=b.length;c&&a<d;++a){c=b[a].phantom!==!0}}return c}});Ext.define('Sch.model.Recurrence',{extend:'Sch.model.Customizable',idProperty:'Id',isRecurrenceModel:!0,customizableFields:[{name:'Frequency',defaultValue:'DAILY'},{name:'Interval',type:'int',defaultValue:1},{name:'EndDate',type:'date'},{name:'Count',type:'int',allowNull:!0},{name:'Days',convert:function(a,b){if(a){if(Ext.isString(a)){a=a.split(',')}}else {a=null}return a},isEqual:function(a,b){return String(a)===String(b)}},{name:'MonthDays',convert:function(a,b){if(a){if(Ext.isString(a)){a=Ext.Array.map(a.split(','),function(a){return parseInt(a,10)})}}else {a=null}return a},isEqual:function(a,b){return String(a)===String(b)}},{name:'Months',convert:function(a,b){if(a){if(Ext.isString(a)){a=Ext.Array.map(a.split(','),function(a){return parseInt(a,10)})}}else {a=null}return a},isEqual:function(a,b){return String(a)===String(b)}},{name:'Positions',convert:function(a,b){if(a){if(Ext.isString(a)){a=Ext.Array.map(a.split(','),function(a){return parseInt(a,10)})}}else {a=null}return a},isEqual:function(a,b){return String(a)===String(b)}}],frequencyField:'Frequency',intervalField:'Interval',endDateField:'EndDate',countField:'Count',daysField:'Days',monthDaysField:'MonthDays',monthsField:'Months',positionsField:'Positions',inheritableStatics:{DAILY:'DAILY',WEEKLY:'WEEKLY',MONTHLY:'MONTHLY',YEARLY:'YEARLY'},dateFormat:'Ymd\\THis\\Z',event:null,rule:null,suspendedEventNotifying:0,constructor:function(a){a=a||{};var b,c;if(a.event){c=a.event;delete a.event}if(a.rule){b=a.rule;delete a.rule}this.callParent(arguments);this.suspendEventNotifying();if(b){this.setRule(b)}this.resumeEventNotifying();this.event=c},sanitize:function(){var a=this,h=a.getFrequency(),f=a.getEvent(),b=f&&f.getStartDate();a.sanitizing=!0;switch(h){case 'DAILY':a.setPositions(null);a.setDays(null);a.setMonthDays(null);a.setMonths(null);break;case 'WEEKLY':a.setPositions(null);a.setMonthDays(null);a.setMonths(null);var e=a.getDays(),g=Sch.data.util.recurrence.DayRuleEncoder.encodeDay;if(b&&e&&e.length==1&&e[0]==g(b.getDay())){a.setDays(null)};break;case 'MONTHLY':if(a.getMonthDays()&&a.getMonthDays().length){a.setPositions(null);a.setDays(null)};a.setMonths(null);var c=a.getMonthDays();if(b&&c&&c.length==1&&c[0]==b.getDate()){a.setMonthDays(null)};break;case 'YEARLY':a.setMonthDays(null);var d=a.getMonths();if(b&&d&&d.length==1&&d[0]==b.getMonth()+1){a.setMonths(null)};break;}a.sanitizing=!1},copy:function(){var a=this.callParent(arguments);a.dateFormat=this.dateFormat;a.event=this.event;return a},set:function(b,c){this.callParent(arguments);if(!this.sanitizing){this.sanitize()}var a=this.getEvent();if(a&&!this.suspendedEventNotifying){a.onRecurrenceChanged()}},suspendEventNotifying:function(){this.suspendedEventNotifying++},resumeEventNotifying:function(){if(this.suspendedEventNotifying){this.suspendedEventNotifying--}},getEvent:function(){return this.event},setEvent:function(a){return this.event=a},getRule:function(){var a=this,b=[];if(a.getFrequency()){b.push('FREQ='+a.getFrequency());if(a.getInterval()>1){b.push('INTERVAL='+a.getInterval())}if(a.getDays()&&a.getDays().length){b.push('BYDAY='+a.getDays().join(','))}if(a.getMonthDays()&&a.getMonthDays().length){b.push('BYMONTHDAY='+a.getMonthDays().join(','))}if(a.getMonths()&&a.getMonths().length){b.push('BYMONTH='+a.getMonths().join(','))}if(a.getCount()){b.push('COUNT='+a.getCount())}if(a.getEndDate()){b.push('UNTIL='+Ext.Date.format(a.getEndDate(),a.dateFormat))}if(a.getPositions()&&a.getPositions().length){b.push('BYSETPOS='+a.getPositions().join(','))}}return b.join(';')},setRule:function(f){var a=this;if(f){a.beginEdit();var d=f.split(';');for(var c=0,g=d.length;c<g;c++){var e=d[c].split('='),b=e[1];switch(e[0]){case 'FREQ':a.setFrequency(b);break;case 'INTERVAL':a.setInterval(b);break;case 'COUNT':a.setCount(b);break;case 'UNTIL':a.setEndDate(Ext.Date.parse(b,a.dateFormat));break;case 'BYDAY':a.setDays(b);break;case 'BYMONTHDAY':a.setMonthDays(b);break;case 'BYMONTH':a.setMonths(b);break;case 'BYSETPOS':a.setPositions(b);break;}}a.endEdit()}}});Ext.define('Sch.data.util.DelayedCalls',{singleton:!0,mixins:['Ext.util.Observable'],delayedCallTimeout:100,delayedCalls:null,constructor:function(a){this.mixins.observable.constructor.call(this,a);Ext.apply(this,a)},cancel:function(){var e=this,a=e.delayedCalls;if(a){var d=arguments.length?arguments:Ext.Oject.getKeys(a);for(var c=d.length-1;c>=0;c--){var b=d[c];if(a[b]&&a[b].timer){clearTimeout(a[b].timer);a[b].timer=null}}}},execute:function(a){var b=a.scope,c;this.fireEvent('delayed-'+a.id+'-start',this,a);a.beforeFn&&a.beforeFn.call(b,a);var d=a.fn;while(c=a.entries.shift()){d.apply(b,c)}a.afterFn&&a.afterFn.call(b,a);this.fireEvent('delayed-'+a.id+'-end',this,a)},schedule:function(c){c=c||{};var a=this;a.delayedCalls=a.delayedCalls||{};var b=c.id||a.schedule.caller.$name;var e=c.args||[];if(!a.delayedCalls[b]){a.delayedCalls[b]=Ext.apply({scope:this},{id:b,entries:[]},c);delete a.delayedCalls[b].args}var d=a.delayedCalls[b];a.cancel(b);d.entries.push(e);d.timer=setTimeout(function(){a.execute(d);delete a.delayedCalls[b]},c.timeout||a.delayedCallTimeout);return d}});Ext.define('Sch.data.util.recurrence.AbstractIterator',{frequency:'NONE',MAX_OCCURRENCES_COUNT:1000000,getNthDayInPeriod:function(f,g,j,d){var a,b,e,c;if(d){var i=86400000,h=604800000;if(d>0){b=1;c=f}else {b=-1;c=g}e=j-c.getDay();if(b*e<0){d+=b}a=new Date(c.getTime()+(d-b)*h+e*i);if(a<f||a>g){a=null}}return a},buildDate:function(d,b,c){var a=new Date(d,b,c);if(a.getFullYear()==d&&a.getMonth()==b&&a.getDate()==c){return a}},isValidPosition:function(a){return Boolean(a)},forEachDateAtPositions:function(c,e,i,h){var g=c.length,f={};for(var d=0;d<e.length;d++){var a=e[d];if(this.isValidPosition(a)){var b=a>0?c[a-1]:c[g+a];if(b&&!f[b.getTime()]){f[b.getTime()]=!0;if(i.call(h,b)===!1){return !1}}}}}});Ext.define('Sch.data.util.recurrence.DailyIterator',{extend:'Sch.data.util.recurrence.AbstractIterator',requires:['Sch.util.Date'],singleton:!0,frequency:'DAILY',forEachDate:function(d){var l=this,e=d.recurrence,p=e.getEvent(),c=p.getStartDate(),f=d.startDate||c,h=e.getEndDate(),a=d.endDate||h,r=d.fn,q=d.scope||l,i=Sch.util.Date,k=e.getInterval(),g=e.getCount(),j=0;if(h&&a&&a>h){a=h}if(c>f){f=c}var o=f-c,n=k*86400000,m=Math.floor(o/n);if(!a&&!g){g=l.MAX_OCCURRENCES_COUNT}var b=i.add(c,i.DAY,m);while(!a||b<=a){j++;if(b>=f){if(a&&b>a||r.call(q,b,j)===!1||g&&j>=g){break}}b=i.add(b,i.DAY,k)}}});Ext.define('Sch.data.util.recurrence.DayRuleEncoder',{singleton:!0,dayParseRegExp:/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,decodeDay:function(c){var b,a;if(b=this.dayParseRegExp.exec(c)){a=[];switch(b[2]){case 'SU':a.push(0);break;case 'MO':a.push(1);break;case 'TU':a.push(2);break;case 'WE':a.push(3);break;case 'TH':a.push(4);break;case 'FR':a.push(5);break;case 'SA':a.push(6);break;}if(a){if(b[1]){b[1]=parseInt(b[1],10)}a.push(b[1])}}return a},encodeDay:function(b){var c;if(Ext.isArray(b)){b=b[0];c=b[1]}var a=c?c.toString():'';switch(b){case 0:a+='SU';break;case 1:a+='MO';break;case 2:a+='TU';break;case 3:a+='WE';break;case 4:a+='TH';break;case 5:a+='FR';break;case 6:a+='SA';break;}return a},decode:function(a){var d=[],c;if(a){for(var b=0;b<a.length;b++){if(c=this.decodeDay(a[b])){d.push(c)}}}return d},encode:function(a){var c=[],d;if(a){for(var b=0;b<a.length;b++){if(d=this.encodeDay(a[b])){c.push(d)}}}return c}});Ext.define('Sch.data.util.recurrence.WeeklyIterator',{extend:'Sch.data.util.recurrence.AbstractIterator',requires:['Sch.util.Date','Sch.data.util.recurrence.DayRuleEncoder'],singleton:!0,frequency:'WEEKLY',forEachDate:function(a){var n=this,c=Sch.util.Date,r=a.fn,q=a.scope||n,b=a.recurrence,p=a.event||b&&b.getEvent(),e=a.eventStartDate||p.getStartDate(),j=a.startDate||e,k=b&&b.getEndDate(),d=a.endDate||k,o=a.interval||b.getInterval(),g=Sch.data.util.recurrence.DayRuleEncoder.decode(a.days||b&&b.getDays()),h=a.count||b&&b.getCount(),l=0,f,i;if(k&&d&&d>k){d=k}if(g&&g.length){g.sort(function(a,b){return a[0]-b[0]})}else {g=[[e.getDay()]]}if(e>j){j=e}if(h){f=c.getNext(e,c.WEEK,0,0)}else {f=c.getNext(j,c.WEEK,0,0)}if(!d&&!h){h=n.MAX_OCCURRENCES_COUNT}while(!d||f<=d){for(var m=0;m<g.length;m++){i=c.copyTimeValues(c.add(f,c.DAY,g[m][0]),e);if(i>=e){l++;if(i>=j){if(d&&i>d||r.call(q,i,l)===!1||h&&l>=h){return}}}}f=c.getNext(f,c.WEEK,o,0)}}});Ext.define('Sch.data.util.recurrence.MonthlyIterator',{extend:'Sch.data.util.recurrence.AbstractIterator',requires:['Sch.util.Date','Sch.data.util.recurrence.DayRuleEncoder'],singleton:!0,frequency:'MONTHLY',getNthDayOfMonth:function(b,a){var d=null,c=Ext.Date.getDaysInMonth(b);if(a&&Math.abs(a)<=c){d=new Date(b.getFullYear(),b.getMonth(),a<0?c+a+1:a)}return d},isValidPosition:function(a){return a&&Math.abs(a)>0&&Math.abs(a)<=31},forEachDate:function(d){var r=this,e=Sch.util.Date,x=d.fn,w=d.scope||r,c=d.recurrence,A=d.event||c.getEvent(),g=d.eventStartDate||A.getStartDate(),m=d.startDate||g,q=c&&c.getEndDate(),f=d.endDate||q,y=d.interval||c.getInterval(),z=d.days||c&&c.getDays(),k=Sch.data.util.recurrence.DayRuleEncoder.decode(z),n=d.monthDays||c&&c.getMonthDays(),j=d.count||c&&c.getCount(),v=d.positions||c&&c.getPositions(),t=v&&v.length,h=0,p={},s,i,u,l,a,b;if(q&&f&&f>q){f=q}if(g>m){m=g}if(j){i=new Date(e.getNext(g,e.MONTH,0))}else {i=new Date(e.getNext(m,e.MONTH,0))}u=new Date(e.getNext(i,e.MONTH,1)-1);if(!(n&&n.length)&&!(k&&k.length)){n=[g.getDate()]}if(k&&k.length){Ext.each(k,function(a){if(a[1]){s=s||{};s[a[0]]=a[1]}})}top: while((!f||f>=i)&&(!j||h<j)){l=[];if(k&&k.length){Ext.each(k,function(c){var h=c[0],d=1,f=53;if(c[1]){d=f=c[1]}for(b=d;b<=f;b++){if(a=r.getNthDayInPeriod(i,u,h,b)){a=e.copyTimeValues(a,g);if(!p[a.getTime()]){p[a.getTime()]=!0;l.push(a)}}}});l.sort(function(a,b){return a-b});if(!t){for(b=0;b<l.length;b++){a=l[b];if(a>=g){h++;if(a>=m){if(f&&a>f||x.call(w,a,h)===!1||j&&h>=j){return !1}}}}}}else {var o=[];for(b=0;b<n.length;b++){if((a=r.getNthDayOfMonth(i,n[b]))&&!p[a.getTime()]){p[a.getTime()]=!0;o.push(a)}}o.sort(function(a,b){return a-b});for(b=0;b<o.length;b++){a=e.copyTimeValues(o[b],g);if(t){l.push(a)}else {if(a>=g){h++;if(a>=m){if(f&&a>f||x.call(w,a,h)===!1||j&&h>=j){break top}}}}}}if(t&&l.length){r.forEachDateAtPositions(l,v,function(a){if(a>=g){h++;if(a>=m&&(!f||a<=f)){if(x.call(w,a,h)===!1||j&&h>=j){return !1}}}})}i=e.getNext(i,e.MONTH,y);u=new Date(e.getNext(i,e.MONTH,1)-1)}}});Ext.define('Sch.data.util.recurrence.YearlyIterator',{extend:'Sch.data.util.recurrence.AbstractIterator',requires:['Sch.util.Date','Sch.data.util.recurrence.DayRuleEncoder'],singleton:!0,frequency:'YEARLY',forEachDate:function(c){var q=this,d=Sch.util.Date,w=c.fn,v=c.scope||q,b=c.recurrence,z=c.event||b.getEvent(),f=c.eventStartDate||z.getStartDate(),n=c.startDate||f,p=b&&b.getEndDate(),g=c.endDate||p,x=c.interval||b.getInterval(),y=c.days||b&&b.getDays(),k=Sch.data.util.recurrence.DayRuleEncoder.decode(y),m=c.months||b&&b.getMonths(),j=c.count||b&&b.getCount(),u=c.positions||b&&b.getPositions(),s=u&&u.length,h=0,o={},r,i,t,l,a,e;if(p&&g&&g>p){g=p}if(f>n){n=f}if(j){i=new Date(d.getNext(f,d.YEAR,0))}else {i=new Date(d.getNext(n,d.YEAR,0))}t=new Date(d.getNext(i,d.YEAR,1)-1);m&&m.sort(function(a,b){return a-b});if(!(m&&m.length)&&!(k&&k.length)){m=[f.getMonth()+1]}if(k&&k.length){Ext.each(k,function(a){if(a[1]){r=r||{};r[a[0]]=a[1]}})}top: while((!g||g>=i)&&(!j||h<j)){l=[];if(k&&k.length){Ext.each(k,function(b){var h=b[0],c=1,g=53;if(b[1]){c=g=b[1]}for(e=c;e<=g;e++){if(a=q.getNthDayInPeriod(i,t,h,e)){a=d.copyTimeValues(a,f);if(!o[a.getTime()]){o[a.getTime()]=!0;l.push(a)}}}});l.sort(function(a,b){return a-b});if(!s){for(e=0;e<l.length;e++){a=l[e];if(a>=f){h++;if(a>=n){if(g&&a>g||w.call(v,a,h)===!1||j&&h>=j){return !1}}}}}}else {for(e=0;e<m.length;e++){if(a=q.buildDate(i.getFullYear(),m[e]-1,f.getDate())){a=d.copyTimeValues(a,f);if(!o[a.getTime()]){o[a.getTime()]=!0;if(s){l.push(a)}else {if(a>=f){h++;if(a>=n){if(g&&a>g||w.call(v,a,h)===!1||j&&h>=j){break top}}}}}}}}if(s&&l.length){q.forEachDateAtPositions(l,u,function(a){if(a>=f){h++;if(a>=n&&(!g||a<=g)){if(w.call(v,a,h)===!1||j&&h>=j){return !1}}}})}i=d.getNext(i,d.YEAR,x);t=new Date(d.getNext(i,d.YEAR,1)-1)}}});Ext.define('Sch.data.mixin.RecurringEvents',{extend:'Ext.Mixin',requires:['Sch.model.Recurrence','Sch.data.util.DelayedCalls','Sch.data.util.recurrence.DailyIterator','Sch.data.util.recurrence.WeeklyIterator','Sch.data.util.recurrence.MonthlyIterator','Sch.data.util.recurrence.YearlyIterator'],isRecurringEventStore:!0,delayedCallTimeout:100,setupRecurringEvents:function(){this.recurrenceIterators=this.recurrenceIterators||[];this.addRecurrenceIterators(Sch.data.util.recurrence.DailyIterator,Sch.data.util.recurrence.WeeklyIterator,Sch.data.util.recurrence.MonthlyIterator,Sch.data.util.recurrence.YearlyIterator);this.relayEvents(Sch.data.util.DelayedCalls,['delayed-regenerate-occurrences-start','delayed-regenerate-occurrences-end','delayed-generate-occurrences-start','delayed-generate-occurrences-end']);this.mon(Sch.data.util.DelayedCalls,{'delayed-regenerate-occurrences-end':this.onDelayedRegenerateOccurrencesEnd,'delayed-generate-occurrences-end':this.onDelayedGenerateOccurrencesEnd,scope:this});this.on('destroy',this.onEventStoreDestroy,this)},onEventStoreDestroy:function(){Sch.data.util.DelayedCalls.cancel('generate-occurrences','regenerate-occurrences')},addRecurrenceIterators:function(){for(var a=0;a<arguments.length;a++){this.recurrenceIterators[arguments[a].frequency]=arguments[a]}},getRecurrenceIteratorForEvent:function(a){return this.recurrenceIterators[a.getRecurrence().getFrequency()]},buildOccurrencesForEvent:function(a,f,i,d){var b=[];if(a.isRecurring()&&a.getStartDate()){var j=this,e=a.getRecurrence(),h=j.getRecurrenceIteratorForEvent(a);var g=a.getEndDate()-a.getStartDate();var c=a.getExceptionDates()?Ext.Array.toMap(a.getExceptionDates(),function(a){return a-0}):{};h.forEachDate({recurrence:e,startDate:f,endDate:i,fn:function(e){if(!c[e-0]&&(!d||!a.getOccurrenceByStartDate(e))){b.push(a.buildOccurrence(e,g))}}})}return b},mergeDelayedCallEntries:function(m){var h=m.entries,j={},c,d,k,e,a;for(var b=0;b<h.length;b++){a=h[b];k=a[0];c=a[1];d=a[2];for(var l=0;l<k.length;l++){e=k[l];var g=j[e.getId()];if(g){if(g[1]>c){g[1]=c}if(g[2]<d){g[2]=d}}else {j[e.getId()]=[[e]].concat(a.slice(1))}}}h=Ext.Object.getValues(j);var f={};for(b=0;b<h.length;b++){a=h[b];e=a[0];c=a[1];d=a[2];var i=(c?c.getTime():'')+'-'+(d?d.getTime():'');if(f[i]){f[i][0]=f[i][0].concat(e)}else {f[i]=a}}m.entries=Ext.Object.getValues(f)},regenerateOccurrencesForEventsBuffered:function(a,d,e){var b=this;if(!Ext.isIterable(a)){a=[a]}a=Ext.Array.filter(a,function(a){return a.isRecurring()});if(a.length){var c=Sch.data.util.DelayedCalls.schedule({id:'regenerate-occurrences',timeout:b.delayedCallTimeout,beforeFn:b.mergeDelayedCallEntries,fn:function(d,e,f){var a=c.occurrencesToRemove=c.occurrencesToRemove||[];a.push.apply(a,b.getOccurrencesForEvents(d));b.generateOccurrencesForEvents(d,e,f,!1)},args:[a,d,e],afterFn:function(a){a.occurrencesToRemove.length&&b.remove(a.occurrencesToRemove)},scope:b})}},generateOccurrencesForEventsBuffered:function(a,d,e,c){var b=this;c=c!==!1;if(!Ext.isIterable(a)){a=[a]}a=Ext.Array.filter(a,function(a){return a.isRecurring()});if(a.length){Sch.data.util.DelayedCalls.schedule({id:'generate-occurrences',timeout:b.delayedCallTimeout,beforeFn:b.mergeDelayedCallEntries,fn:b.generateOccurrencesForEvents,args:[a,d,e,c],scope:b})}},generateOccurrencesForEvents:function(a,e,k,c){if(a){var b=this,j=[],d=[];c=c!==!1;if(!Ext.isIterable(a)){a=[a]}if(a.length){b.fireEvent('generate-occurrences-start',b,a,e,k,c);for(var l=0;l<a.length;l++){var f=a[l],g,h,i;if(j=b.buildOccurrencesForEvent(f,e,k,c)){i=f.getStartDate();if(e<=i){if(h=j.shift()){g=h.getStartDate();if(g-i){f.setStartEndDate(g,h.getEndDate());f.getRecurrence().sanitize()}}}d.push.apply(d,j)}}if(d.length){b.add(d)}b.fireEvent('generate-occurrences-end',b,a,d,e,k,c)}}},generateOccurrencesForAll:function(d,e,c){var a=this,b;if((b=a.getRecurringEvents())&&b.length){a.fireEvent('generate-occurrences-all-start',a,b,d,e,c);a.generateOccurrencesForEvents(b,d,e,c);a.fireEvent('generate-occurrences-all-end',a,b,d,e,c)}},getRecurringEvents:function(){var a=this;return a.queryBy(function(a){return a.isRecurrableEvent&&a.isRecurring()}).getRange()},getOccurrencesForEvents:function(a){var b=[];if(!Ext.isIterable(a)){a=[a]}if(a.length){for(var c=0;c<a.length;c++){var d=a[c].getId();b.push.apply(b,this.queryBy(function(a){return a.isRecurrableEvent&&a.getRecurringEventId()==d}).getRange())}}return b},getOccurrencesForAll:function(){return this.queryBy(function(a){return a.isRecurrableEvent&&a.isOccurrence()}).getRange()},removeOccurrencesForEvents:function(a){return this.remove(this.getOccurrencesForEvents(a))},removeOccurrencesForAll:function(){return this.remove(this.getOccurrencesForAll())},onDelayedRegenerateOccurrencesEnd:function(){this.fireEvent('occurrencesready',this)},onDelayedGenerateOccurrencesEnd:function(){this.fireEvent('occurrencesready',this)}});Ext.define('Sch.patches.DateFieldConvertDate',{extend:'Sch.util.Patch',target:'Ext.data.field.Date',minVersion:'7.0.0',maxVersion:'8.0.0',overrides:{convert:function(a){if(!a){return null}if(a instanceof Date){return a}var b=this.dateReadFormat||this.dateFormat,c;if(b){if((b==='c'||b==='C')&&/Z$/.test(a)){var d=new Date(a);return !isNaN(d.getTime())?d:null}return Ext.Date.parse(a,b,this.useStrict)}c=Date.parse(a);return c?new Date(c):null}}});Ext.define('Sch.model.Range',{extend:'Sch.model.Customizable',requires:['Sch.util.Date','Sch.patches.DateFieldConvertDate'],idProperty:'Id',isRangeModel:!0,startDateField:'StartDate',endDateField:'EndDate',nameField:'Name',clsField:'Cls',customizableFields:[{name:'StartDate',type:'date',dateFormat:'c'},{name:'EndDate',type:'date',dateFormat:'c'},{name:'Cls',type:'string'},{name:'Name',type:'string'}],setStartDate:function(c,d){var b=this.getEndDate();var a=this.getStartDate();this.beginEdit();this.set(this.startDateField,c);if(d===!0&&b&&a){this.setEndDate(Sch.util.Date.add(c,Sch.util.Date.MILLI,b-a))}this.endEdit()},setEndDate:function(c,d){var a=this.getStartDate();var b=this.getEndDate();this.beginEdit();this.set(this.endDateField,c);if(d===!0&&a&&b){this.setStartDate(Sch.util.Date.add(c,Sch.util.Date.MILLI,-(b-a)))}this.endEdit()},setStartEndDate:function(a,b){this.beginEdit();this.set(this.startDateField,a);this.set(this.endDateField,b);this.endEdit()},getDates:function(){var b=[],d=this.getEndDate();if(this.isScheduled()){var c=Ext.Date.clearTime(this.getStartDate(),!0);if(d-this.getStartDate()===0){b.push(c)}else {for(var a=c;a<d;a=Sch.util.Date.add(a,Sch.util.Date.DAY,1)){b.push(a)}}}return b},forEachDate:function(b,a){return Ext.Array.each(this.getDates(),b,a)},isScheduled:function(){var a=this;return Boolean(a.getStartDate()&&a.getEndDate()&&a.areDatesValid())},isValid:function(){var d=this,a=d.callParent(),b,c;if(a){b=d.getStartDate(),c=d.getEndDate();a=!b||!c||c-b>=0}return a},areDatesValid:function(){var c=this,a=c.getStartDate(),b=c.getEndDate();return !a||!b||b-a>=0},shift:function(b,a){this.setStartEndDate(Sch.util.Date.add(this.getStartDate(),b,a),Sch.util.Date.add(this.getEndDate(),b,a))},fullCopy:function(){return this.copy.apply(this,arguments)},intersectsRange:function(c,d){var a=this.getStartDate();var b=this.getEndDate();return a&&b&&Sch.util.Date.intersectSpans(a,b,c,d)}});Ext.define('Sch.model.mixin.RecurrableEvent',{extend:'Ext.Mixin',requires:['Sch.model.Recurrence'],isRecurrableEvent:!0,recurringEventIdField:'RecurringEventId',recurrenceRuleField:'RecurrenceRule',exceptionDatesField:'ExceptionDates',customizableFields:[{name:'RecurringEventId'},{name:'RecurrenceRule',allowNull:!0,convert:function(a,b){if(Ext.isEmpty(a)){a=null}return a}},{name:'ExceptionDates',dateFormat:'c',convert:function(a,d){if(a){var b=this.dateFormat,c=this.useStrict;a=Ext.isString(a)?a.split(','):a;a=Ext.Array.map(a,function(a){if(!Ext.isDate(a)){a=Ext.Date.parse(a,b,c)}return a})}return a}}],recurrenceModel:'Sch.model.Recurrence',setRecurrence:function(c,g,d){var b=this,e,a,h;if(b.isOccurrence()){var f=b.getRecurringEvent();e=f&&f.getRecurrence();b.setRecurringEventId(null)}if(c){e&&e.setEndDate(new Date(b.getStartDate()-1));if(c.isRecurrenceModel){a=c}else {if(Ext.isObject(c)){a=new this.recurrenceModel(c)}else {a=new this.recurrenceModel();a.setFrequency(c);g&&a.setInterval(g);if(d){if(d instanceof Date){a.setEndDate(d)}else {a.setCount(d)}}}}a.setEvent(b);h=a.getRule()}b.recurrence=a;b.set(b.recurrenceRuleField,h)},getRecurrence:function(){var a=this,b=a.getRecurrenceRule();if(!a.recurrence&&b){a.recurrence=new a.recurrenceModel({rule:b,event:a})}return a.recurrence},isRecurring:function(){return this.getRecurrence()&&!this.isOccurrence()},isOccurrence:function(){return Boolean(this.getRecurringEventId())},getRecurringEvent:function(){var a=this.getRecurringEventId(),b=this.getEventStore();return a&&b&&b.getModelById(a)},getOccurrenceByStartDate:function(c){var d,a;if(c){a=this.getOccurrences();for(var b=0;b<a.length;b++){if(a[b].getStartDate()-c===0){d=a[b];break}}}return d},getOccurrences:function(){var a=this.getEventStore();return a&&a.getOccurrencesForEvents(this)},removeOccurrences:function(){var a=this.getEventStore();return a&&a.removeOccurrencesForEvents(this)},onRecurrenceChanged:function(){var a=this.getRecurrence();this.setRecurrenceRule(a&&a.getRule()||null)},buildOccurrence:function(c,b){b=b||this.getEndDate()-this.getStartDate();var a=this.copy(null);a.beginEdit();a.setStartEndDate(c,new Date(c.getTime()+b));a.setRecurringEventId(this.getId());a.endEdit();return a},setRecurrenceRule:function(b){var a=this,c;if(b!=a.getRecurrenceRule()){if(b){c=new a.recurrenceModel({rule:b,event:a})}a.recurrence=c;a.set(a.recurrenceRuleField,b)}},addExceptionDate:function(a){var b=this,c=b.getExceptionDates()||[];if(a){b.setExceptionDates(c.concat(a))}},beforeStartDateChange:function(){this._startDateValue=this.getStartDate()},afterStartDateChange:function(){if(this._startDateValue-this.getStartDate()&&this.getExceptionDates()){this.setExceptionDates()}},mixinConfig:{before:{setStartDate:'beforeStartDateChange',setStartEndDate:'beforeStartDateChange'},after:{setStartDate:'afterStartDateChange',setStartEndDate:'afterStartDateChange'},extended:function(d,c,b){var a=b.recurrenceModel;if(typeof a=='string'){Ext.require(a,function(){b.recurrenceModel=Ext.data.schema.Schema.lookupEntity(a);Ext.override(c,{recurrenceModel:Ext.data.schema.Schema.lookupEntity(a)})})}}},onClassMixedIn:function(a){var b=a.prototype.recurrenceModel||this.prototype.recurrenceModel;if(typeof b=='string'){Ext.require(b,function(){Ext.override(a,{recurrenceModel:Ext.data.schema.Schema.lookupEntity(b)})})}Ext.override(a,{isPersistable:function(){var a=this;return a.callParent(arguments)&&!a.isOccurrence()},set:function(a,b){if(typeof a=='string'?a==this.recurrenceRuleField:this.recurrenceRuleField in a){this.recurrence=null}return this.callParent(arguments)},customizableFields:(a.prototype.customizableFields||[]).concat(this.prototype.customizableFields)})}});Ext.define('Sch.model.Event',{extend:'Sch.model.Range',uses:['Sch.util.Date'],idProperty:'Id',mixins:['Sch.model.mixin.RecurrableEvent'],isEventModel:!0,customizableFields:[{name:'IconCls'},{name:'ResourceId'},{name:'Draggable',type:'boolean',persist:!1,defaultValue:!0},{name:'Resizable',persist:!1,defaultValue:!0},{name:'AllDay',defaultValue:!1}],resourceIdField:'ResourceId',draggableField:'Draggable',resizableField:'Resizable',allDayField:'AllDay',iconClsField:'IconCls',getInternalId:function(){return this.internalId},isHighlighted:!1,getEventStore:function(){var b=this,a=b.joined&&b.joined[0];if(a&&!a.isEventStore){Ext.Array.sort(b.joined,function(a,b){return (a.isEventStore||!1)>(b.isEventStore||!1)&&-1||1});a=b.joined[0];a=a.isEventStore?a:null}return a},getResourceStore:function(){var a=this.getEventStore();return a&&a.getResourceStore()},getAssignmentStore:function(){var a=this.getEventStore();return a&&a.getAssignmentStore()},getResources:function(a){var b=this;a=a||b.getEventStore();return a&&a.getResourcesForEvent(b)||[]},forEachResource:function(d,c){var b=this.getResources();for(var a=0;a<b.length;a++){if(d.call(c||this,b[a])===!1){return}}},getResource:function(b){var d=this,a=null,c=d.getEventStore(),e=c&&c.getResourceStore();b=b==null?d.getResourceId():b;if(c&&(b===null||b===undefined)){a=c.getResourcesForEvent(d);if(a.length==1){a=a[0]}else {if(a.length>1){Ext.Error.raise('Event::getResource() is not applicable for events with multiple assignments, please use Event::getResources() instead.')}else {a=null}}}else {if(e){a=e.getModelById(b)}}return a},setResource:function(c){var a=this,b=a.getEventStore();b&&b.removeAssignmentsForEvent(a);a.assign(c)},assign:function(a){var b=this,c=b.getEventStore();if(a&&a.isResourceModel){a=a.getId()}if(c){c.assignEventToResource(b,a)}else {b.setResourceId(a)}},unassign:function(a){var b=this,c=b.getEventStore();if(a&&a.isResourceModel){a=a.getId()}if(c){c.unassignEventFromResource(b,a)}else {if(b.getResourceId()==a){b.setResourceId(null)}}},reassign:function(b,a){var c=this,d=c.getEventStore();if(b&&b.isResourceModel){b=b.getId()}if(a&&a.isResourceModel){a=a.getId()}if(d){d.reassignEventFromResourceToResource(c,b,a)}else {c.setResourceId(a)}},isAssignedTo:function(a){var c=this,d=c.getEventStore(),b=!1;if(a&&a.isResourceModel){a=a.getId()}if(d){b=d.isEventAssignedToResource(c,a)}else {b=c.getResourceId()==a}return b},getAssignments:function(){var b=this,a=b.getEventStore();return a&&a.getAssignmentsForEvent(b)},isDraggable:function(){return this.getDraggable()},isResizable:function(){return this.getResizable()},isPersistable:function(){var b=this,a=b.getEventStore();return a&&a.isEventPersistable(b)},getStartDate:function(){var a=this.data[this.startDateField];if(this.getAllDay()){a=this.statics().getAllDayStartDate(a)}return a},getEndDate:function(){var a=this.data[this.endDateField];if(this.getAllDay()){a=this.statics().getAllDayEndDate(a)}return a},inheritableStatics:{getAllDayStartDate:function(a){if(a instanceof Sch.model.Event){a=a.get(a.startDateField)}if(a){a=Sch.util.Date.clearTime(a,!0)}return a},getAllDayEndDate:function(a){if(a instanceof Sch.model.Event){a=a.get(a.endDateField)}if(a&&(a.getHours()>0||a.getMinutes()>0||a.getSeconds()>0||a.getMilliseconds()>0)){a=Sch.util.Date.getNext(a,'d',1)}return a},getAllDayDisplayStartDate:function(a){if(a instanceof Sch.model.Event){a=a.get(a.startDateField)}return Sch.util.Date.clearTime(a,!0)},getAllDayDisplayEndDate:function(b,a){var c=b;if(b instanceof Sch.model.Event){b=c.get(c.startDateField);a=c.get(c.endDateField)}b=Sch.model.Event.getAllDayDisplayStartDate(b);if(Sch.util.Date.clearTime(a,!0).valueOf()===a.valueOf()){a=Sch.util.Date.add(a,Sch.util.Date.DAY,-1)}else {if(b.valueOf()!==a.valueOf()){a=Sch.util.Date.clearTime(a,!0)}}return a}}});Ext.define('Sch.data.EventStore',{extend:'Ext.data.Store',alias:'store.eventstore',mixins:['Sch.data.mixin.UniversalModelGetter','Sch.data.mixin.CacheHintHelper','Sch.data.mixin.EventStore','Robo.data.Store','Sch.data.mixin.RecurringEvents'],storeId:'events',model:'Sch.model.Event',config:{model:'Sch.model.Event'},constructor:function(b){var a=this;a.callParent([b]);a.resourceStore&&a.setResourceStore(a.resourceStore);a.assignmentStore&&a.setAssignmentStore(a.assignmentStore);if(a.getModel()!==Sch.model.Event&&!(a.getModel().prototype instanceof Sch.model.Event)){throw 'The model for the EventStore must subclass Sch.model.Event'}a.setupRecurringEvents()},append:function(a){this.add(a)}});Ext.define('Kanban.model.Task',{extend:'Sch.model.Event',alias:'model.kanban_taskmodel',resourceStore:null,states:['NotStarted','InProgress','Test','Done'],customizableFields:[{name:'State',defaultValue:'NotStarted'},{name:'Position',type:'int'},{name:'CreatedDate',type:'date'},{name:'ImageUrl'}],constructor:function(){this.callParent(arguments);if(this.phantom&&!this.getCreatedDate()){this.setCreatedDate(new Date())}},stateField:'State',imageUrlField:'ImageUrl',createdDateField:'CreatedDate',positionField:'Position',getResourceStore:function(){if(!this.resourceStore){Ext.Array.each(this.joined,function(a){if(a.resourceStore){this.resourceStore=a.resourceStore;return !1}},this)}return this.resourceStore},isValidTransition:function(a){var b=this.getState();if(b===a){return !0}switch(this.getState()){case 'NotStarted':return a=='InProgress';case 'InProgress':return a!='Done';case 'Test':return a!='NotStarted';case 'Done':return a=='Test'||a=='InProgress';default:return !0;}}});Ext.define('Kanban.data.TaskStore',{extend:'Sch.data.EventStore',model:'Kanban.model.Task',proxy:undefined,alias:'store.kanban_taskstore',resourceStore:null,setResourceStore:function(a){this.resourceStore=Ext.data.StoreManager.lookup(a)},getResourceStore:function(){return this.resourceStore},constructor:function(){this.callParent(arguments);var a=this.getModel();this.setSorters([{property:a.prototype.positionField,direction:'ASC'},{property:a.prototype.nameField,direction:'ASC'}])}});Ext.define('Kanban.data.mixin.StoreView',{state:null,masterStore:null,getStoreListeners:function(){return {add:this.onMasterAdd,clear:this.onMasterClear,remove:this.onMasterRemove,update:this.onMasterUpdate,refresh:this.onMasterDataChanged,scope:this}},unbindFromStore:function(){this.masterStore.un(this.getStoreListeners())},bindToStore:function(a){var b=this.getStoreListeners();if(this.masterStore){this.masterStore.un(b)}this.masterStore=a;if(a){a.on(b);this.copyStoreContent()}},onMasterAdd:function(c,b){for(var a=0;a<b.length;a++){if(b[a].getState()===this.state){this.add(b[a])}}},onMasterClear:function(){this.removeAll()},onMasterUpdate:function(c,a,d,b){if(b&&Ext.Array.indexOf(b,c.model.prototype.stateField)>=0){if(this.state===a.getState()){this.add(a)}if(this.state===a.previous[a.stateField]){this.remove(a)}}},onMasterRemove:function(b,a){Ext.Array.each(a,function(a){if(a.getState()===this.state){this.remove(a)}},this)},onMasterDataChanged:function(a){this.copyStoreContent()},copyStoreContent:function(){var b=this.state;var a=[];this.masterStore.each(function(c){if(c.getState()===b){a[a.length]=c}});this.suspendEvents();this.loadData(a);this.resumeEvents();this.sort(this.masterStore.getSorters().items);this.sorters.removeAll()}});Ext.define('Kanban.data.ViewStore',{extend:'Ext.data.Store',mixins:['Kanban.data.mixin.StoreView'],proxy:'memory',masterStore:null,state:null,constructor:function(a){Ext.apply(this,a);if(this.state===null||this.state===undefined){throw 'Must supply state'}if(this.masterStore){var b=this.masterStore=Ext.StoreMgr.lookup(this.masterStore);this.model=b.model}else {throw 'Must supply a master store'}this.callParent(arguments);if(this.masterStore){this.bindToStore(this.masterStore)}},getResourceStore:function(){return this.masterStore.getResourceStore()}});Ext.define('Kanban.dd.DragZone',{extend:'Ext.dd.DragZone',mixins:{observable:'Ext.util.Observable'},requires:['Ext.util.Point'],panel:null,repairHighlight:!1,repairHighlightColor:'transparent',containerScroll:!1,autoOffset:function(a,b){this.setDelta(this.dragData.offsets[0],this.dragData.offsets[1])},setVisibilityForSourceEvents:function(a){Ext.each(this.dragData.taskEls,function(b){b[a?'removeCls':'addCls']('sch-hidden')})},constructor:function(a){this.mixins.observable.constructor.call(this,a);this.callParent(arguments);this.proxy.el.child('.x-dd-drag-ghost').removeCls('x-dd-drag-ghost');this.proxy.addCls('sch-task-dd')},getPlaceholderElements:function(d,b){var e=b.taskEls;var a;var g=b.offsets[0];var h=b.offsets[1];var f=d.getHeight();var c=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap-holder'});Ext.Array.each(e,function(b,e){a=b.dom.cloneNode(!0);a.innerHTML='';a.id=Ext.id();a.boundView=b.dom.boundView;var d=Ext.fly(a);d.removeCls('sch-task-selected');d.addCls('sch-task-placeholder');c.appendChild(a);Ext.fly(a).setStyle({width:b.getWidth()+'px',height:b.getHeight()+'px'})});return c},getDragData:function(a){var e=this.panel,g=a.getTarget(e.taskSelector);if(!g||e.isReadOnly()){return}var c=e.resolveRecordByNode(g);if(!c||c.isDraggable()===!1||this.fireEvent('beforetaskdrag',this,c,a)===!1){return null}a.preventDefault();var n=a.getXY(),d=Ext.get(g),l=d.getXY(),h=[n[0]-l[0],n[1]-l[1]],f=Ext.getCmp(d.up('.sch-taskview').id),o=d.getRegion();if(!f.isSelected(g)&&!a.ctrlKey){this.fireEvent('taskdragstarting',this,c,a)}var j=this.getDraggingRecords(c),k=[];Ext.Array.forEach(j,function(b){var a=e.getElementForTask(b);if(a){k.push(a)}});var b={view:f,sourceZoomLevel:f.up('panel').zoomLevel,offsets:h,repairXY:[a.getX()-h[0],a.getY()-h[1]],taskEls:k,bodyScroll:Ext.getBody().getScroll(),taskRecords:j};var m=f.getStore();var i=m.getAt(m.indexOf(c)+1);if(i){b.dropOptions={task:i,type:'before'}}b.ddel=this.getDragElement(d,b);b.placeholder=this.getPlaceholderElements(d,b);this.proxy.el.set({size:this.panel.getZoomLevel()});return b},onStartDrag:function(b,c){var a=this.dragData;Ext.fly(a.placeholder).insertBefore(a.taskEls[0]);Ext.Array.forEach(a.taskEls,function(a){a.addCls('sch-hidden')});this.fireEvent('taskdragstart',this,a.taskRecords)},getDraggingRecords:function(b){var a=this.getRelatedRecords(b);var c=b.store;if(a[0]&&a[0].getState()==b.getState()){a=Ext.Array.sort([b].concat(a),this.positionSorter)}else {a=[b].concat(Ext.Array.sort(a,this.positionSorter))}return a},positionSorter:function(b,c){var a=b.store;return a.indexOf(b)>a.indexOf(c)?1:-1},getRelatedRecords:function(b){var d=this.panel;var c=d.getSelectedRecords();var a=[];Ext.each(c,function(c){if(c.getId()!==b.getId()&&c.isDraggable()!==!1){a.push(c)}});return a},getDragElement:function(c,b){var d=b.taskEls;var a;var i=b.offsets[0];var j=b.offsets[1];var g=this.panel.getElementForTask(b.taskRecords[0]).getHeight();if(d.length>1){var f=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap',style:{overflow:'visible'}});Ext.Array.forEach(d,function(b,c){a=b.dom.cloneNode(!0);a.id='';a.className+=c===0?' sch-dd-source':' sch-dd-extra';var e=b.up('[size]');var d=Ext.core.DomHelper.createDom({tag:'div',size:e.getAttribute('size')}).cloneNode(!0);d.appendChild(a);f.appendChild(d);Ext.fly(a).setStyle({left:(c>0?10:0)+'px',top:(c===0?0:g-30+c*20)+'px',width:b.getWidth()+'px',height:b.getHeight()+'px',position:'absolute'})});return f}else {a=c.dom.cloneNode(!0);a.id='';a.style.width=c.getWidth()+'px';a.style.height=c.getHeight()+'px';var h=c.up('[size]');var e=Ext.core.DomHelper.createDom({tag:'div',size:h.getAttribute('size')}).cloneNode(!0);e.appendChild(a);return e}},getRepairXY:function(b,a){return a.repairXY},afterRepair:function(){this.dragging=!1},onInvalidDrop:function(b,a,d){if(!a){a=b;b=a.getTarget()||document.body}var c=this.callParent([b,a,d]);this.fireEvent('aftertaskdrop',this,this.dragData.taskRecords);if(this.dragData.placeholder){Ext.fly(this.dragData.placeholder).remove()}this.setVisibilityForSourceEvents(!0);return c}});Ext.define('Kanban.dd.DropZone',{extend:'Ext.dd.DropZone',mixins:{observable:'Ext.util.Observable'},constructor:function(a){this.callParent(arguments);this.mixins.observable.constructor.call(this,a)},panel:null,dragData:null,getTargetFromEvent:function(a){return a.getTarget()},validatorFn:Ext.emptyFn,validatorFnScope:null,zoomLevels:['large','medium','small','mini'],shouldDropBeforeNode:function(d,f,c){var a=Ext.fly(f).getBox();var e=c.proxy.getXY();var b;if(this.dropMode==='vertical'){b=(a.bottom-a.top)/2;if(this.direction.up){return e[1]-a.top<b}else {var g=Ext.fly(c.dragData.placeholder.children[0]).getHeight();return e[1]+g-a.top<b}}else {b=(a.right-a.left)/2;if(Ext.Array.indexOf(this.zoomLevels,c.dragData.currentZoomLevel)>Ext.Array.indexOf(this.zoomLevels,c.dragData.sourceZoomLevel)){if(d[1]<a.top){return !0}else {if(d[1]>a.bottom){return !1}}return d[0]-a.left<(a.right-a.left)/2}else {if(d[1]<a.top){return !0}else {if(d[1]>a.bottom){return !1}}if(this.direction.left){return e[0]-a.left<b}else {var h=Ext.fly(c.dragData.placeholder.children[0]).getWidth();return e[0]+h-a.left<b}}}},getDropMode:function(a){var b=Ext.DomQuery.select(a.getItemSelector()+':not(.sch-hidden)',a.el.dom)[0];if(!b){return 'vertical'}if(Ext.fly(b).getWidth()*2<a.getWidth()){return 'horizontal'}return 'vertical'},updatePlaceholderElements:function(b,f){var a;var c=Ext.core.DomHelper.createDom({tag:'div',cls:'sch-dd-wrap-holder'});for(var e=0,g=f.taskRecords.length;e<g;e++){a=b.cloneNode(!0);a.innerHTML='';a.boundView=b.boundView;a.id=Ext.id();var d=Ext.fly(a);d.removeCls('sch-task-selected');d.addCls('sch-task-placeholder');c.appendChild(a);Ext.fly(a).setStyle({width:b.offsetWidth+'px',height:b.offsetHeight+'px'})}return c},getSmallestTask:function(d){var b=Ext.DomQuery.select(d.getItemSelector()+':not(.sch-hidden)',d.el.dom);var a=b[0];for(var c=0;c<b.length;c++){a=a.offsetHeight>b[c].offsetHeight?b[c]:a}return a},getNodeByCoordinate:function(b,a){return document.elementFromPoint(b[0]-a.left,b[1]-a.top)},getTargetView:function(d,e,c){var a=this.getNodeByCoordinate(d,c.bodyScroll);if(a){if(!a.className.match('sch-taskview')){var b=Ext.fly(a).up('.sch-taskview');if(b){a=b.dom}else {a=null}}if(a){return Ext.getCmp(a.id)}}return null},onNodeOver:function(s,j,q,a){var f=q.getXY();this.direction={left:!1,up:!1};var n=this.prevXY;if(n){if(n[0]>f[0]){this.direction.left=!0}else {}if(n[1]>f[1]){this.direction.up=!0}}this.prevXY=f;var o=j.proxy.el.dom;var m=!1;o.style.display='none';var b=this.getTargetView(f,q,a);o.style.display='block';if(!b){return this.dropNotAllowed}if(b){m=a.taskRecords[0].isValidTransition(b.state);if(m){if(b!=a.view){var p=this.getSmallestTask(b);if(p){Ext.fly(a.placeholder).remove();a.placeholder=this.updatePlaceholderElements(p,a)}}if(b!=a.view||!this.dropMode){this.dropMode=this.getDropMode(b);a.currentZoomLevel=b.up('panel').zoomLevel}a.view=b;var k=Ext.get(a.placeholder);var d=b.all.elements.slice(),i=0,e=d.length-1,c,h,g;if(d.length){while(e-i>1){h=Math.floor((i+e)/2);c=d[h];if(Ext.fly(c).isVisible()){g=this.shouldDropBeforeNode(f,c,j);if(g){e=h}else {i=h}}else {d.splice(h,1);e=e-1}}var l=d[i],r=this.shouldDropBeforeNode(f,l,j);if(r){c=l;g=!0}else {if(Ext.fly(d[e]).isVisible()){c=d[e];g=this.shouldDropBeforeNode(f,c,j)}else {c=l;g=!1}}}if(c){if(g){k.insertBefore(c);a.dropOptions={task:b.getRecord(c),type:'before'}}else {k.insertAfter(c);a.dropOptions={task:b.getRecord(c),type:'after'}}}else {b.el.appendChild(k);a.dropOptions=null}}}return m?this.dropAllowed:this.dropNotAllowed},notifyDrop:function(f,g,a){var i=g.getXY();f.proxy.el.dom.style.display='none';var e=this.getTargetView(i,g,a);f.proxy.el.dom.style.display='block';var b=this,c=e&&e.state,h=!0,d=c!==!1&&c!==null;a.newState=c;a.view=e;a.proxy=f.proxy;a.finalize=function(){b.finalize.apply(b,arguments)};d=d&&b.validatorFn.call(b.validatorFnScope||this,a.taskRecords,c)!==!1;this.dragData=a;h=b.fireEvent('beforetaskdropfinalize',b,a,g)!==!1;if(h){return b.finalize(d)}return !0},finalize:function(k){var a=this.dragData,i=a.proxy,c=[];Ext.fly(this.getEl()).select('.sch-dd-wrap-holder').remove();Ext.Array.forEach(a.taskEls,function(a){a.removeCls('sch-hidden')});if(k){var h=a.taskRecords,j=h[0].positionField,g=a.newState,f=a.dropOptions,b=a.view.getStore(),e=b.masterStore;e.suspendAutoSync();Ext.Array.each(h,function(a){if(a.isValidTransition(g)){a.setState(g);c.push(a)}});if(c.length>0){b.remove(c);var l=f?b.indexOf(f.task)+(f.type=='before'?0:1):b.getCount();b.insert(l,c);for(var d=0;d<b.getCount();d++){b.getAt(d).set(j,d,{silent:!0})}b.sort()}e.resumeAutoSync(e.autoSync)}if(c.length===0){i.el.dom.style.display='block';i.el.animate({duration:500,easing:'ease-out',to:{x:a.repairXY[0],y:a.repairXY[1]},stopAnimation:!0})}else {this.fireEvent('taskdrop',this,a.taskRecords)}delete this.dropMode;this.fireEvent('aftertaskdrop',this,a.taskRecords);if(a.placeholder){Ext.fly(a.placeholder).remove()}return c.length>0}});Ext.define('Kanban.editor.Base',{triggerEvent:'taskdblclick',panel:null,selector:'.sch-task',editRecord:function(a,c){if(this.panel.isReadOnly()){return}var b=this.panel.getElementForTask(a);if(b){this.triggerEdit(a,c)}},triggerEdit:function(a,b){throw 'Abstract method call'},init:function(a){this.panel=a;if(this.triggerEvent){a.on(this.triggerEvent,function(d,a,c,b){this.editRecord(a,b)},this);a.on('taskkeydown',function(c,b,d,a){if(a.getKey()===a.ENTER&&a.getTarget().nodeName.toLowerCase()!=='input'){this.editRecord(b,a)}},this)}}});Ext.define('Kanban.editor.SimpleEditor',{extend:'Ext.Editor',mixins:['Kanban.editor.Base'],alias:'widget.kanban_simpleeditor',alignment:'tl',autoSize:{width:'boundEl'},selector:'.sch-task-name',dataIndex:'Name',field:{xtype:'textfield',minWidth:100,allowEmpty:!1},minWidth:100,initComponent:function(){var a=this;a.on('complete',a.onEditDone,a);a.callParent()},triggerEdit:function(b,e){var a=this.panel.getElementForTask(b);if(a){var d=this.panel.resolveViewByNode(a);var c=d.up('panel').zoomLevel;if(c!=='mini'){this.record=b;this.startEdit(a.down(this.selector))}}},onEditDone:function(){this.record.set(this.dataIndex,this.getValue())}});Ext.define('Kanban.field.AddNew',{extend:'Ext.form.TextField',alias:'widget.addnewfield',enableKeyEvents:!0,emptyText:'Add new task...',store:null,defaults:null,initComponent:function(){this.on('keyup',this.onMyKeyUp,this);if(Ext.isString(this.store)){this.store=Ext.getStore(this.store)}this.callParent(arguments)},onMyKeyUp:function(b,a){if(a.getKey()===a.ENTER){this.addTask()}},addTask:function(){var c={};var a=this.up('taskcolumn');c[this.store.model.prototype.nameField]=this.getValue();var e=this.store.add(Ext.apply(c,this.defaults))[0];this.reset();if(a){var d=a.down('taskview'),b=d.getNode(e);if(b){Ext.fly(b).scrollIntoView(d.el,!1,!0)}}}});Ext.define('Kanban.field.ColumnFilter',{extend:'Ext.form.ComboBox',alias:'widget.columnfilter',requires:['Ext.data.JsonStore'],multiSelect:!0,valueField:'id',displayField:'name',panel:null,queryMode:'local',listConfig:{htmlEncode:!0,cls:'sch-columnfilter-list'},initComponent:function(){var a=this;a.store=new Ext.data.JsonStore({proxy:'memory',fields:['id','name']});a.loadStore();a.callParent(arguments);a.getPicker().on({beforeshow:a.onBeforeColumnListShow,scope:a});a.getPicker().on({show:function(b){b.on('selectionchange',a.applyFilterToColumns,a)},hide:function(b){b.un('selectionchange',a.applyFilterToColumns,a)},delay:50,scope:a});a.value=a.value||a.panel.query('taskcolumn').map(function(a){return a.state});a.applyFilterToColumns()},loadStore:function(){var a=this,b=Sch.locale.Active['Kanban.locale']||{},c=a.panel.query('taskcolumn').map(function(a){return {id:a.state,name:a.origTitle||b[a.state]||a.state}});a.store.loadData(c)},applyFilterToColumns:function(){var a=this,b=a.value;a.store.each(function(c){var e=a.panel.down('[state='+c.get('id')+']'),d=Ext.Array.indexOf(b,c.get('id'))>=0;e[d?'show':'hide']()})},onBeforeColumnListShow:function(){var a=this,b=[];Ext.each(a.panel.query('taskcolumn'),function(c){if(c.isVisible()){b.push(a.store.getById(c.state))}});a.select(b)}});Ext.define('Kanban.field.TaskFilter',{extend:'Ext.form.TextField',alias:'widget.filterfield',requires:['Ext.util.Filter'],enableKeyEvents:!0,minLength:2,store:null,caseSensitive:!1,initComponent:function(){this.on('change',this.onMyChange,this);this.store=Ext.data.StoreManager.lookup(this.store);this.field=this.field||this.store.getModel().prototype.nameField;this.filter=this.filter||new Ext.util.Filter({id:this.getId()+'-filter',property:this.field,value:'',caseSensitive:this.caseSensitive,anyMatch:!0});this.callParent(arguments)},onMyChange:function(){var a=this.getValue();if(a&&a.length>=this.minLength){this.filter.setValue(a);this.store.addFilter(this.filter)}else {this.store.removeFilter(this.filter)}}});Ext.define('Kanban.field.TaskHighlight',{extend:'Ext.form.TextField',alias:'widget.highlightfield',mixins:['Ext.AbstractPlugin'],enableKeyEvents:!0,minLength:2,preventMark:!0,panel:null,field:'Name',caseSensitive:!1,initComponent:function(){this.on('keyup',this.onMyKeyUp,this);this.callParent(arguments)},onMyKeyUp:function(c,d){var a=this.getValue();if(a&&a.length>=this.minLength){var b=[];a=this.caseSensitive?a:a.toLowerCase();this.panel.highlightTasksBy(function(c){var b=this.caseSensitive?c.data[this.field]:c.data[this.field].toLowerCase();return b&&b.indexOf(a)>=0},this)}else {this.panel.clearHighlight()}}});Ext.define('Kanban.locale.En',{extend:'Sch.locale.Locale',singleton:!0,constructor:function(a){Ext.apply(this,{l10n:{'Kanban.menu.TaskMenuItems':{copy:'Duplicate',remove:'Delete',edit:'Edit',states:'Status',users:'Assign to'}},NotStarted:'Not Started',InProgress:'In Progress',Test:'Test',Done:'Done'});this.callParent(arguments)}});Ext.define('Kanban.menu.UserMenu',{extend:'Ext.menu.Menu',alias:'widget.kanban_usermenu',cls:'sch-usermenu',plain:!0,resourceStore:null,initComponent:function(){var a=this;Ext.apply(this,{renderTo:document.body,listeners:{beforeshow:function(){var a=this.task.getResource();if(a){this.items.each(function(b){if(a==b.user){b.addCls('sch-user-selected')}else {b.removeCls('sch-user-selected')}})}}}});this.resourceStore=Ext.data.StoreManager.lookup(this.resourceStore);this.mon(this.resourceStore,{load:this.populate,add:this.populate,remove:this.populate,update:this.populate,scope:this});this.callParent(arguments);this.populate()},showForTask:function(a,b){this.task=a;if(this.resourceStore.getCount()>0){this.showAt(b)}},onUserSelected:function(a){this.task.assign(a.user)},populate:function(){var b=this;var a=[];this.resourceStore.each(function(c){a.push({text:c.getName(),user:c,handler:b.onUserSelected,scope:b})});this.removeAll(!0);this.add(a)}});Ext.define('Kanban.menu.TaskMenuItems',{requires:['Kanban.editor.SimpleEditor','Kanban.menu.UserMenu'],mixins:['Sch.mixin.Localizable'],taskBoard:null,mainMenu:null,defaultActions:null,editorClass:null,editor:null,userMenuClass:null,userMenu:null,constructor:function(a){Ext.apply(this,a);this.mainMenu.on('beforeshow',this.onBeforeShow,this);this.items=this.items||[];if(this.defaultActions){this.initEditor();this.initUserMenu();this.initStateMenu();this.items=this.items.concat([{action:'edit',text:this.L('edit'),handler:this.onEditClick,scope:this},{action:'assign',text:this.L('users'),menu:this.userMenu},{action:'setState',text:this.L('states'),menu:this.stateMenu},{action:'copy',text:this.L('copy'),handler:this.onCopyClick,scope:this},{action:'remove',text:this.L('remove'),handler:this.onRemoveClick,scope:this}])}this.callParent(arguments)},onBeforeShow:function(b){var a=b.getTask();if(this.userMenu){this.userMenu.task=a}if(this.editor){this.editor.task=a}},getItems:function(){return this.items},initEditor:function(){if(!this.editor){if(this.taskBoard.getTaskEditor()){this.editor=this.taskBoard.getTaskEditor()}else {this.editor=Ext.create(this.editorClass,{dataIndex:this.taskBoard.taskStore.model.prototype.nameField,panel:this.taskBoard})}}},onEditClick:function(b,a){this.editor.editRecord(this.mainMenu.getTask(),a)},initUserMenu:function(){if(!this.userMenu){this.userMenu=Ext.create(this.userMenuClass,{resourceStore:this.taskBoard.resourceStore,onBodyClick:Ext.emptyFn})}},initStateMenu:function(){var a=this,b=this.taskBoard.taskStore.model,c=b.prototype.stateField,f=b.prototype.states;var e=Sch.locale.Active['Kanban.locale']||{};var g=Ext.Array.map(f,function(b){return {text:e[b]||b,state:b,handler:a.onStateClick,scope:a}});var d=a.mainMenu;this.stateMenu=new Ext.menu.Menu({items:g,plain:!0,listeners:{show:function(){var a=d.getTask();var b=a.get(c);this.items.each(function(c){c.setDisabled(c.state===b||!a.isValidTransition(c.state))})}}})},onStateClick:function(a){this.mainMenu.task.setState(a.state)},onCopyClick:function(d){var b=this.taskBoard.taskStore,c=this.mainMenu.getTask(),a=c.copy(null);a.setName(a.getName());b.add(a)},onRemoveClick:function(c){var a=this.taskBoard.taskStore,b=this.mainMenu.getTask();a.remove(b)}});Ext.define('Kanban.menu.TaskMenu',{extend:'Ext.menu.Menu',requires:['Kanban.menu.TaskMenuItems'],isTaskMenu:!0,alias:'widget.kanban_taskmenu',cls:'sch-task-menu',handleCls:'sch-task-menu-handle',taskBoard:null,config:{task:null},hideHandleTimer:null,handleHideDelay:500,currentHandle:null,editorClass:'Kanban.editor.SimpleEditor',userMenuClass:'Kanban.menu.UserMenu',defaultActions:!0,itemFactoryClass:'Kanban.menu.TaskMenuItems',initComponent:function(){this.on('beforeshow',this.onBeforeShow,this);if(this.defaultActions){this.items=Ext.create(this.itemFactoryClass,{editorClass:this.editorClass,userMenuClass:this.userMenuClass,defaultActions:this.defaultActions,items:this.items||[],taskBoard:this.taskBoard,mainMenu:this}).getItems()}this.callParent(arguments)},registerListeners:function(){this.mon(this.taskBoard.el,{click:this.onMenuHandleClick,delegate:'.'+this.handleCls,scope:this});this.mon(this.taskBoard,{taskmouseenter:this.onHandleMouseOver,taskmouseleave:this.onHandleMouseLeave,scope:this})},showForTask:function(a,c,d){var b=c.getTarget('.sch-task');this.setTask(a);this.show();this.alignTo(b,'tl-tr?')},onMenuHandleClick:function(b,a){var c=this.taskBoard.resolveRecordByNode(a);b.stopEvent();this.showForTask(c,b,a)},onHandleMouseOver:function(e,d,a,c,b){window.clearTimeout(this.hideHandleTimer);this.hide();this.currentHandle&&this.currentHandle.setVisible(!1);this.currentHandle=Ext.select('.'+this.handleCls,!1,a).setVisible(!0)},onHandleMouseLeave:function(e,d,a,c,b){this.hideHandleTimer=Ext.defer(function(){this.currentHandle&&this.currentHandle.setVisible(!1)},this.handleHideDelay,this)},shouldShowItem:function(a,b){return !0},onBeforeShow:function(b){var a=this.getTask();this.items.each(function(b){b.task=a;b.setVisible(this.shouldShowItem(b,a))},this)},destroy:function(){clearTimeout(this.hideHandleTimer);this.callParent(arguments)}});Ext.define('Kanban.menu.UserPicker',{extend:'Ext.view.View',alias:['widget.userpicker','widget.kanban_userpicker'],cls:'sch-userpicture-view',autoScroll:!0,showName:!0,padding:'10 5 5 5',itemSelector:'.sch-user',overItemCls:'sch-user-hover',selectedItemCls:'sch-user-selected',initComponent:function(){var a=this.store&&this.store.model&&this.store.model.prototype;var c=a&&a.nameField||'Name';var b=a&&a.imageUrlField||'ImageUrl';Ext.apply(this,{itemTpl:'<tpl for=".">'+'<div class="sch-user">'+'<img src="{'+b+':htmlEncode}" />'+(this.showName?'<span>{'+c+':htmlEncode}</span>':'')+'</div>'+'</tpl>'});this.callParent(arguments)}});Ext.define('Kanban.menu.UserPictureMenu',{extend:'Ext.menu.Menu',alias:['widget.userpicturemenu','widget.kanban_userpicturemenu'],requires:['Kanban.menu.UserPicker'],cls:'sch-userpicturemenu',width:290,height:200,resourceStore:null,hideOnSelect:!0,initComponent:function(){var a=this,b=Ext.apply({},a.initialConfig);delete b.listeners;Ext.apply(a,{plain:!0,showSeparator:!1,bodyPadding:0,items:Ext.applyIf({margin:0,store:this.resourceStore,xtype:'userpicker'},b)});a.callParent(arguments);a.picker=a.down('userpicker');a.relayEvents(a.picker,['select']);if(a.hideOnSelect){a.on('select',a.onUserSelected,a)}this.mon(Ext.getBody(),'click',this.onBodyClick,this)},showForTask:function(a,c){this.task=a;this.showAt(c);var b=a.getResource();if(b){this.picker.select(b,!1,!0)}else {this.picker.getSelectionModel().deselectAll()}},onUserSelected:function(b,a){this.hide();this.task.assign(a)},onBodyClick:function(a,b){if(!a.within(this.el)){this.hide()}}});Ext.define('Kanban.selection.TaskModel',{extend:'Ext.mixin.Observable',panel:null,selModels:null,constructor:function(b){var a=this;Ext.apply(a,b);a.callParent(arguments);a.selModels=Ext.Array.map(a.panel.views,function(a){return a.getSelectionModel()});a.forEachView(function(b){a.mon(b,'containerclick',a.onEmptyAreaClick,a);a.relayEvents(b,['select','deselect']);a.relayEvents(b.getSelectionModel(),['selectionchange'])})},select:function(a,e,d){a=[].concat(a);var c=!1;var b=function(){c=!0};this.forEachSelModel(function(c){var f=Ext.Array.filter(a,function(a){return c.store.indexOf(a)>=0});c.on('selectionchange',b,null,{single:!0});if(f.length>0){c.select(f,e,d)}else {c.deselectAll()}c.un('selectionchange',b,null,{single:!0})});if(c){this.fireEvent('selectionchange',this.getSelection())}},deselect:function(a,b){a=[].concat(a);this.forEachSelModel(function(c){var d=Ext.Array.filter(a,function(a){return c.store.indexOf(a)>=0});c.deselect(d,b)});this.fireEvent('selectionchange',this.getSelection())},selectAll:function(){this.relayMethod('selectAll')},deselectAll:function(){this.relayMethod('deselectAll')},getSelection:function(){return this.relayMethod('getSelection')},getCount:function(){return Ext.Array.sum(this.relayMethod('getCount'))},deselectAllInOtherSelectionModels:function(a){this.forEachSelModel(function(b){b!==a&&b.deselectAll()})},relayMethod:function(a,b){return [].concat.apply([],Ext.Array.map(this.selModels,function(c){return c[a].apply(c,b||[])}))},forEachSelModel:function(b,a){Ext.Array.each(this.selModels,b,a||this)},onEmptyAreaClick:function(){this.deselectAll()},forEachView:function(b,a){Ext.Array.each(this.panel.views,b,a||this)},destroy:function(){}});Ext.define('Kanban.template.Task',{extend:'Ext.XTemplate',model:null,menuIconTpl:'<div class="sch-task-menu-handle x-fa fa-gear"></div>',constructor:function(b){var a=this;b=b||{};b.menuIconTpl=b.menuIconTpl!==undefined?b.menuIconTpl:a.menuIconTpl;Ext.apply(a,b);var c=a.model.prototype;var d=c.idProperty;var e=c.nameField;if(typeof a.taskBodyTpl!=='string'){a.taskBodyTpl='<tpl if="'+c.imageUrlField+'"><img class="sch-task-img" src="{taskImageUrl:htmlEncode}"/></tpl>'+'<span class="sch-task-id">{[ values.'+d+' ? "#" + values.'+d+' : "" ]}</span><span class="sch-task-name"> {'+e+':htmlEncode}</span>'}if(typeof a.resourceImgTpl!=='string'){a.resourceImgTpl='<img src="{resourceImageUrl:htmlEncode}" class="sch-user-avatar {resourceImageCls:htmlEncode}" />'}a.callParent(['<tpl for=".">','<div class="sch-task sch-task-state-{[Ext.String.htmlEncode(values.'+c.stateField+".replace(/\\s/g, '-'))]} {"+c.clsField+':htmlEncode} {cls:htmlEncode} x-unselectable" unselectable="on" style="{style}">'+'<div class="sch-task-inner">'+a.taskBodyTpl+a.resourceImgTpl+(a.taskToolTpl||'')+'</div>'+a.menuIconTpl+'</div>'+'</tpl>'])}});Ext.define('Sch.patches.View',{extend:'Sch.util.Patch',target:'Ext.view.View',minVersion:'5.1.0',overrides:{handleEvent:function(a){var b=this,c=b.keyEventRe.test(a.type),e=b.getNavigationModel();a.view=b;if(c){a.item=a.getTarget(b.itemSelector);a.record=e.getRecord(a.item)}if(!a.item){var d=b.editingPlugin&&b.editingPlugin.getActiveEditor&&b.editingPlugin.getActiveEditor();if(!(d&&d.getEl().contains(a.getTarget()))){a.item=a.getTarget(b.itemSelector)}}if(a.item&&!a.record){a.record=b.getRecord(a.item)}if(b.processUIEvent(a)!==!1){b.processSpecialEvent(a)}if(c&&!Ext.fly(a.target).isInputField()){if(a.getKey()===a.SPACE||a.isNavKeyPress(!0)){a.preventDefault()}}a.view=null}}});Ext.define('Kanban.view.TaskView',{extend:'Ext.view.View',alias:'widget.taskview',requires:['Kanban.template.Task','Kanban.data.ViewStore'],autoScroll:!0,trackOver:!0,overItemCls:'sch-task-over',selectedItemCls:'sch-task-selected',itemSelector:'.sch-task',state:null,taskRenderer:function(b,a){},initComponent:function(){var a=this;if(a.store&&a.store.model){a.tpl=new Kanban.template.Task({model:a.store.model,resourceImgTpl:a.resourceImgTpl,taskToolTpl:a.taskToolTpl,taskBodyTpl:a.taskBodyTpl,menuIconTpl:a.menuIconTpl})}else {a.tpl=new Ext.XTemplate('')}a.addCls('sch-taskview sch-taskview-state-'+a.state.replace(/\s/g,'-'));a.callParent(arguments)},bindStore:function(a){if(a&&a.model){this.tpl=new Kanban.template.Task({model:a.model,resourceImgTpl:this.resourceImgTpl,taskToolTpl:this.taskToolTpl,taskBodyTpl:this.taskBodyTpl,menuIconTpl:this.menuIconTpl})}this.callParent(arguments)},refresh:function(){var b=this.getEl();var a=b.down('.'+Ext.baseCSSPrefix+'view-selector');if(a){b.removeChild(a)}this.callParent(arguments);if(a){b.appendChild(a)}},collectData:function(h){var e=this.callParent(arguments),f=[];for(var c=0;c<e.length;c++){var a=Ext.apply({},e[c]);var b=h[c];var g=b.getResource();var d=g&&g.getImageUrl();a.resourceImageCls='';a.resourceImageUrl=d||Ext.BLANK_IMAGE_URL;a.taskImageUrl=b.getImageUrl();a.task=b;a.name=b.getName();if(!d){a.resourceImageCls='sch-no-img'}this.taskRenderer(b,a);if(b.phantom){a.cls=(a.cls||'')+' sch-phantom-task'}f.push(a)}return f}});Ext.define('Kanban.view.TaskColumn',{extend:'Ext.Panel',alias:'widget.taskcolumn',requires:['Ext.layout.container.Fit','Kanban.view.TaskView'],flex:1,layout:'fit',collapseDirection:'right',state:null,store:null,taskBodyTpl:null,taskToolTpl:null,resourceImgTpl:null,origTitle:null,view:null,zoomLevel:'large',viewConfig:null,initComponent:function(){var a=this;if(a.state===null){throw 'Must supply state'}var b=Ext.apply({state:a.state},a.viewConfig||{});if(a.taskBodyTpl){b.taskBodyTpl=a.taskBodyTpl}if(a.taskToolTpl){b.taskToolTpl=a.taskToolTpl}if(a.resourceImgTpl){b.resourceImgTpl=a.resourceImgTpl}a.items=a.view=new Kanban.view.TaskView(b);var c=Sch.locale.Active['Kanban.locale']||{};a.origTitle=a.title=a.title||c[a.state]||a.state;a.callParent(arguments);a.addCls('sch-taskcolumn sch-taskcolumn-state-'+a.state.replace(/\s/g,'-'))},onRender:function(){this.setZoomLevel(this.zoomLevel);if(this.header){this.header.addCls('sch-taskcolumnheader-state-'+this.state.replace(/\s/g,'-'))}this.callParent(arguments)},refreshTitle:function(){var b=this.state;var a=this.store.query(this.store.getModel().prototype.stateField,b,!1,!1,!0).length;this.setTitle(this.origTitle+(a?' ('+a+')':''))},bindStore:function(a){var b={load:this.refreshTitle,datachanged:this.refreshTitle,update:this.refreshTitle,add:this.refreshTitle,remove:this.refreshTitle,buffer:20,scope:this};if(this.store){this.store.unbindFromStore();this.mun(this.store,b)}if(a){this.mon(a,b);this.view.bindStore(a)}this.store=a;this.refreshTitle()},getZoomLevel:function(){return this.zoomLevel},setZoomLevel:function(a){this.zoomLevel=a||'large';this.el.set({size:a})}});Ext.define('Kanban.view.TaskBoard',{extend:'Ext.Panel',alias:'widget.taskboard',requires:['Sch.patches.View','Kanban.patch.EXTJS_23846','Kanban.locale.En','Kanban.data.TaskStore','Kanban.data.ResourceStore','Kanban.view.TaskColumn','Kanban.dd.DropZone','Kanban.dd.DragZone','Kanban.editor.SimpleEditor','Kanban.field.AddNew','Kanban.menu.UserMenu','Kanban.menu.TaskMenu','Kanban.selection.TaskModel'],border:!1,layout:{type:'hbox',align:'stretch'},defaultType:'taskcolumn',config:{taskStore:null,resourceStore:{type:'kanban_resourcestore'}},fitColumns:!0,dragZoneConfig:null,dropZoneConfig:null,columnClass:'Kanban.view.TaskColumn',columns:null,columnConfigs:null,editor:null,viewConfig:null,enableUserMenu:!0,readOnly:!1,userMenu:null,taskMenu:!0,dndValidatorFn:Ext.emptyFn,validatorFnScope:null,zoomLevel:'large',destroyStores:!1,enableClipboard:!1,taskCls:'sch-task',taskSelector:'.sch-task',isHighlighting:!1,views:null,kanbanColumns:null,selModel:null,clipboard:null,initComponent:function(){var a=this;a.defaults=a.defaults||{};Ext.applyIf(a.defaults,{margin:12});a.taskStore=Ext.data.StoreManager.lookup(a.taskStore);a.resourceStore=Ext.data.StoreManager.lookup(a.resourceStore);a.addCls('sch-taskboard');a.addBodyCls('sch-taskboard-body');if(!a.fitColumns){a.addCls('sch-taskboard-scrollable');a.setScrollable('x');a.setLayout('auto')}var b=a.getConfig('bind');if(b){if(b.taskStore){a.taskStore=new Kanban.data.TaskStore()}if(b.resourceStore){a.resourceStore=new Kanban.data.ResourceStore()}}a.taskStore=Ext.data.StoreManager.lookup(a.taskStore);a.resourceStore=Ext.data.StoreManager.lookup(a.resourceStore);a.on({add:a.onColumnsAdded,remove:a.onColumnsRemoved,scope:a});if(!a.columns){a.columns=a.createColumns()}else {a.columns=Ext.clone(a.columns);a.initColumns(a.columns)}a.items=a.columns;if(!a.taskStore){throw 'Must define a taskStore for the Panel'}if(!a.resourceStore){throw 'Must define a resourceStore for the Panel'}a.callParent(arguments);a.bindResourceStore(a.resourceStore,!0)},setTaskStore:function(a){this.taskStore=Ext.StoreManager.lookup(a);this.taskStore.setResourceStore(this.getResourceStore());this.rendered&&this.forEachColumn(function(a){a.bindStore(new Kanban.data.ViewStore({masterStore:this.taskStore,state:a.state}))})},setResourceStore:function(a){this.bindResourceStore(a)},createColumns:function(){var a=this;var c=a.taskStore.model.prototype.states;var b=a.columnConfigs||{};return Ext.Array.map(c,function(c,d){return Ext.create(a.columnClass,Ext.apply({state:c,viewConfig:a.viewConfig,zoomLevel:a.zoomLevel,layout:a.fitColumns?'fit':'auto',manageHeight:!a.fitColumns},Ext.apply(b[c]||{},b.all)))})},initColumns:function(b){var a=this;Ext.Array.forEach(b,function(b){if(b.items){a.initColumns(b.items)}else {Ext.applyIf(b,{viewConfig:a.viewConfig})}},this)},onColumnsAdded:function(c,a){var b=a instanceof Kanban.view.TaskColumn?[a]:a.query('taskcolumn');Ext.Array.forEach(b,function(a){a.bindStore(new Kanban.data.ViewStore({masterStore:this.taskStore,state:a.state}));this.bindViewListeners(a.view);this.kanbanColumns&&this.kanbanColumns.push(a);this.views&&this.views.push(a.view)},this)},onColumnsRemoved:function(c,a){var b=a instanceof Kanban.view.TaskColumn&&a;Ext.Array.remove(this.kanbanColumns,b);Ext.Array.remove(this.views,b.view)},afterRender:function(){this.callParent(arguments);if(!this.isReadOnly()){this.setupDragDrop();this.initEditor();this.initTaskMenu();if(this.enableUserMenu&&this.userMenu){this.initUserMenu()}}this.views=this.query('taskview');this.kanbanColumns=this.query('taskcolumn');this.on('taskclick',this.onTaskClick,this);if(this.enableClipboard){this.getEl().on({keydown:this.onKeyDown,scope:this})}},onKeyDown:function(b){var a=this;if(!b.ctrlKey){return}switch(b.browserEvent.key.toLowerCase()){case 'c':a.copyTasksToClipboard();break;case 'v':a.pasteTasks();break;case 'x':a.cutTasksToClipboard();break;}},copyTasksToClipboard:function(){var a=this;a.clipboard=a.getSelectedRecords();a.clipboard.copy=!0},cutTasksToClipboard:function(){var a=this;a.clipboard=a.getSelectedRecords();a.clipboard.copy=!1;a.clipboard.forEach(function(c){var b=a.getElementForTask(c);b&&b.addCls('sch-taskboard-cut-task')})},pasteTasks:function(){var a=this;var b=a.resolveState(document.activeElement);if(a.clipboard&&b!==!1){a.clipboard.forEach(function(c){c=a.clipboard.copy?c.copy(null):c;c.setState(b);if(a.clipboard.copy){a.taskStore.add(c)}var d=a.getElementForTask(c);d&&d.removeCls('sch-taskboard-cut-task')})}},setReadOnly:function(a){this.readOnly=a},isReadOnly:function(){return this.readOnly},bindViewListeners:function(a){a.on({itemclick:this.getTaskListener('taskclick'),itemcontextmenu:this.getTaskListener('taskcontextmenu'),itemdblclick:this.getTaskListener('taskdblclick'),itemmouseenter:this.getTaskListener('taskmouseenter'),itemmouseleave:this.getTaskListener('taskmouseleave'),itemkeydown:this.getTaskListener('taskkeydown'),itemkeyup:this.getTaskListener('taskkeyup'),scope:this})},setupDragDrop:function(){var a=this;var b='kanban-dd-'+a.id,c=a.el;a.dragZone=new Kanban.dd.DragZone(a.body.id,Ext.apply({panel:a,containerScroll:!a.fitColumns,ddGroup:b},a.dragZoneConfig));a.dropZone=new Kanban.dd.DropZone(a.body.id,Ext.apply({panel:a,validatorFn:a.dndValidatorFn,validatorFnScope:a.validatorFnScope,ddGroup:b},a.dropZoneConfig));a.relayEvents(a.dragZone,['beforetaskdrag','taskdragstart','aftertaskdrop']);this.relayEvents(this.dropZone,['beforetaskdropfinalize','taskdrop','aftertaskdrop']);this.dropZone.on('aftertaskdrop',this.onAfterTaskDrop,this);this.dragZone.on('taskdragstarting',this.onDragStarting,this)},resolveState:function(b){if(Ext.isIE&&!b){b=document.body}if(!b.dom){var a=Ext.fly(b);if(!a.is('.sch-taskview')){a=a.up('.sch-taskview')}if(a&&a.component){return a.component.state}}return !1},setZoomLevel:function(a){this.translateToColumns('setZoomLevel',[a])},getZoomLevel:function(){return this.down('taskcolumn').getZoomLevel()},initEditor:function(){if(this.editor){if(!this.editor.isComponent){this.editor=Ext.widget(this.editor)}this.editor.init(this)}},initUserMenu:function(){if(!(this.userMenu instanceof Ext.Component)){this.userMenu=Ext.ComponentManager.create(this.userMenu)}this.el.on({click:this.onUserImgClick,delegate:'.sch-user-avatar',scope:this})},initTaskMenu:function(){if(this.taskMenu){var a=typeof this.taskMenu==='boolean'?{xtype:'kanban_taskmenu'}:this.taskMenu;if(Ext.isArray(a)){a={items:a}}a.taskBoard=this;if(!a.isTaskMenu){this.taskMenu=Ext.widget(Ext.applyIf(a,{xtype:'kanban_taskmenu'}))}this.taskMenu.registerListeners();this.addCls('sch-taskboard-with-menu')}},onUserImgClick:function(a,b){a.stopEvent();if(!this.isReadOnly()){this.userMenu.showForTask(this.resolveRecordByNode(b),a.getXY())}},resolveViewByNode:function(b){var a=Ext.fly(b).up('.sch-taskview');return a&&Ext.getCmp(a.id)||null},resolveRecordByNode:function(b){var a=this.resolveViewByNode(b);return a&&a.getRecord(a.findItemByChild(b))||null},onTaskClick:function(b,c,d,a){if(!a.ctrlKey){this.deselectAllInOtherViews(b)}},deselectAllInOtherViews:function(a){this.getSelectionModel().deselectAllInOtherSelectionModels(a.getSelectionModel())},getElementForTask:function(a){if(!(a instanceof Ext.data.Model)){a=this.taskStore.getById(a)}var b=a.getState();if(b){return Ext.get(this.getViewForState(b).getNode(a))}},getViewForState:function(a){return this.down('taskview[state='+[a]+']')},forEachColumn:function(b,a){Ext.Array.each(this.query('taskcolumn'),b,a||this)},translateToViews:function(a,b){Ext.Array.map(this.views,function(c){return c[a].apply(c,b||[])})},translateToColumns:function(a,b){Ext.Array.map(this.kanbanColumns,function(c){return c[a].apply(c,b||[])})},translateToSelectionModels:function(a,b){Ext.Array.map(this.views,function(d){var c=d.getSelectionModel();c[a].apply(c,b||[])})},getSelectedRecords:function(){return [].concat.apply([],Ext.Array.map(this.views,function(a){return a.getSelectionModel().getSelection()}))},selectAll:function(){this.getSelectionModel().selectAll()},deselectAll:function(){this.getSelectionModel().deselectAll()},onDestroy:function(){Ext.destroy(this.dragZone,this.dropZone,this.userMenu,this.taskMenu,this.editor);this.clipboard=null;if(this.destroyStores){this.taskStore.destroy();this.resourceStore.destroy()}},getTaskListener:function(a){return function(e,b,d,f,c){this.fireEvent(a,e,b,d,c)}},highlightTasksBy:function(d,e){if(!this.isHighlighting){this.el.addCls('sch-taskboard-filtered');this.isHighlighting=!0}this.el.select('.sch-filter-match').removeCls('sch-filter-match');for(var a=0,f=this.taskStore.getCount();a<f;a++){var b=this.taskStore.getAt(a);if(d.call(e||this,b)){var c=this.getElementForTask(b);if(c){c.addCls('sch-filter-match')}}}},clearHighlight:function(){this.isHighlighting=!1;this.el.removeCls('sch-taskboard-filtered');this.el.select('.sch-filter-match').removeCls('sch-filter-match')},refresh:function(){this.translateToViews('refresh');this.fireEvent('refresh',this)},refreshTaskNode:function(b){var a=this.getElementForTask(b);if(a){var c=this.resolveViewByNode(a);c.refreshNode(b)}},bindResourceStore:function(a,c){var b={update:this.onResourceStoreUpdate,refresh:this.onResourceStoreRefresh,remove:this.onResourceStoreRemove,scope:this};if(this.resourceStore){this.mun(this.resourceStore,b)}if(a){a=Ext.data.StoreManager.lookup(a);this.mon(a,b);this.taskStore&&this.taskStore.setResourceStore(a);if(!c&&this.rendered){this.refresh()}}this.resourceStore=a},onResourceStoreUpdate:function(){if(this.rendered){this.refresh()}},onResourceStoreRefresh:function(){if(this.rendered){this.refresh()}},onResourceStoreRemove:function(){if(this.rendered){this.refresh()}},onDragStarting:function(d,a,b){var c=this.getViewForState(a.getState());if(!b.ctrlKey){this.deselectAll()}},onAfterTaskDrop:function(){this.getSelectionModel().deselectAll()},getTaskMenu:function(){return this.taskMenu},getTaskStore:function(){return this.taskStore},getResourceStore:function(){return this.resourceStore},getTaskEditor:function(){return this.editor},getSelectionModel:function(){if(!this.selModel){this.selModel=this.createSelectionModel()}return this.selModel},createSelectionModel:function(){var a=new Kanban.selection.TaskModel({panel:this});this.relayEvents(a,['deselect','select']);return a}},function(){Ext.apply(Kanban,{VERSION:'2.0.31',LICENSE:'%LICENSE%'})});Ext.define('Sch.model.Assignment',{extend:'Sch.model.Customizable',idProperty:'Id',isAssignmentModel:!0,customizableFields:[{name:'ResourceId'},{name:'EventId'}],resourceIdField:'ResourceId',eventIdField:'EventId',getInternalId:function(){return this.internalId},getAssignmentStore:function(){return this.joined&&this.joined[0]},getEventStore:function(){var a=this.getAssignmentStore();return a&&a.getEventStore()},getResourceStore:function(){var a=this.getEventStore();return a&&a.getResourceStore()},getEvent:function(a){var b=this;a=a||b.getEventStore();return a&&a.getModelById(b.getEventId())},getResource:function(a){var b=this;a=a||b.getResourceStore();return a&&a.getModelById(b.getResourceId())},getEventName:function(b){var a=this.getEvent(b);return a&&a.getName()||''},getResourceName:function(b){var a=this.getResource(b);return a&&a.getName()||''},isPersistable:function(){var c=this,b=c.getEvent(),a=c.getResource();return b&&!b.phantom&&a&&!a.phantom},fullCopy:function(){return this.copy.apply(this,arguments)},getEventResourceCompositeKey:function(){var a=this;return a.self.makeAssignmentEventResourceCompositeKey(a.getEventId(),a.getResourceId())},inheritableStatics:{makeAssignmentEventResourceCompositeKey:function(){var a=[];return function(c,b){a.length=0;a.push('event(',c,')-resource(',b,')');return a.join('')}}()}});